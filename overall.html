<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Legacy Investing - Complete Presentation</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        /* ========================================
           BRAND COLOR PALETTE - PRESTON SLIDES
           ======================================== */
        :root {
            --dark-green: #0f4c3a;
            --dark-green-mid: #0a3d2f;
            --dark-green-deep: #072820;
            --light-green: #1a7a5e;
            --gold: #d4af37;
            --gold-dark: #b8962e;
            --off-white: #fafafa;
            --near-black: #1a1a1a;
            --red: #c53030;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #111;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 60px 20px;
            overflow-y: auto;
        }

        h1, h2, h3 {
            font-family: 'Playfair Display', serif;
        }

        .slide {
            width: 100%;
            max-width: 1280px;
            aspect-ratio: 16 / 9;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            margin-bottom: 60px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        /* ========================================
           PATH A STYLES
           ======================================== */
        .slide-path-a {
            background: #0B3F30;
            padding: 40px 55px;
            display: flex;
            flex-direction: column;
        }

        .whats-included-header {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 12px;
        }

        .path-eyebrow {
            color: #d4af37;
            font-size: 12px;
            font-weight: 700;
            letter-spacing: 4px;
            text-transform: uppercase;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .path-eyebrow::before {
            content: '';
            width: 40px;
            height: 2px;
            background: #d4af37;
        }

        .whats-included-header h1 {
            font-size: 38px;
            color: #fff;
            font-weight: 500;
        }

        .whats-included-h2 {
            font-size: 26px;
            color: rgba(255, 255, 255, 0.85);
            font-weight: 400;
            margin-bottom: 20px;
            font-family: 'Playfair Display', serif;
        }

        .checklist-floating {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px 40px;
            margin-bottom: 28px;
        }

        .floating-item {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
        }

        .floating-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .floating-item:nth-child(1) { margin-left: 0; }
        .floating-item:nth-child(2) { margin-left: 20px; }
        .floating-item:nth-child(3) { margin-left: 30px; }
        .floating-item:nth-child(4) { margin-left: 10px; }
        .floating-item:nth-child(5) { margin-left: 15px; }
        .floating-item:nth-child(6) { margin-left: 35px; }
        .floating-item:nth-child(7) { margin-left: 5px; }
        .floating-item:nth-child(8) { margin-left: 25px; }

        .floating-item .check-badge {
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #0B3F30, #1a7a5e);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 12px;
            flex-shrink: 0;
        }

        .floating-item span {
            color: #1a1a1a;
            font-size: 13px;
            font-weight: 600;
        }

        .curriculum-section {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .curriculum-header {
            display: flex;
            align-items: center;
            gap: 14px;
            margin-bottom: 20px;
        }

        .curriculum-header::before {
            content: '';
            width: 40px;
            height: 3px;
            background: linear-gradient(90deg, #d4af37, transparent);
        }

        .curriculum-header h2 {
            font-size: 28px;
            color: #fff;
            font-weight: 500;
        }

        .curriculum-header h2 span {
            color: rgba(255, 255, 255, 0.5);
            font-weight: 400;
            font-style: italic;
        }

        .pillars-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 14px;
        }

        .pillar-card {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 12px;
            padding: 16px 14px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
        }

        .pillar-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.2);
        }

        .pillar-card .num {
            font-size: 26px;
            font-weight: 800;
            color: #d4af37;
            line-height: 1;
            margin-bottom: 6px;
        }

        .pillar-card h3 {
            font-size: 12px;
            color: #0B3F30;
            font-weight: 700;
            margin-bottom: 5px;
            font-family: 'Inter', sans-serif;
            line-height: 1.3;
        }

        .pillar-card p {
            font-size: 10px;
            color: #555;
            line-height: 1.4;
        }

        /* ========================================
           PATH B STYLES
           ======================================== */
        .slide-arbitrage-model {
            background: radial-gradient(ellipse at center, #0f4c3a 0%, #0a3d2f 50%, #072820 100%);
            padding: 45px 55px;
            display: flex;
            flex-direction: column;
        }

        .slide-arbitrage-model .header,
        .slide-dfy-b .header,
        .slide-features .header,
        .slide-services .header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 8px;
        }

        .header-badge {
            width: 42px;
            height: 42px;
            background: linear-gradient(135deg, #d4af37, #b8962e);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1a1a1a;
            font-size: 18px;
            font-weight: 800;
            flex-shrink: 0;
        }

        .slide-arbitrage-model .header h1,
        .slide-dfy-b .header h1,
        .slide-features .header h1 {
            font-size: 38px;
            color: #fff;
            font-weight: 500;
        }

        .slide-arbitrage-model .subtitle {
            color: rgba(255, 255, 255, 0.6);
            font-size: 15px;
            margin-bottom: 28px;
            margin-left: 58px;
        }

        .steps-flow {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 28px;
        }

        .step-card {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 14px;
            padding: 24px 20px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .step-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, rgba(212, 175, 55, 0.12) 0%, transparent 70%);
        }

        .step-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.25);
        }

        .step-card .num {
            font-size: 36px;
            font-weight: 800;
            color: #d4af37;
            line-height: 1;
            margin-bottom: 10px;
        }

        .step-card h3 {
            font-size: 15px;
            color: #0f4c3a;
            font-weight: 700;
            margin-bottom: 6px;
            font-family: 'Inter', sans-serif;
        }

        .step-card p {
            font-size: 12px;
            color: #555;
            line-height: 1.5;
        }

        .bottom-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 35px;
            flex: 1;
        }

        .why-section {
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .why-section .eyebrow {
            color: #d4af37;
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-bottom: 18px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .why-section .eyebrow::before {
            content: '';
            width: 35px;
            height: 2px;
            background: #d4af37;
        }

        .why-stack {
            display: flex;
            flex-direction: column;
            position: relative;
            padding-left: 10px;
        }

        .why-card {
            display: flex;
            align-items: center;
            gap: 14px;
            background: #fff;
            border-radius: 14px;
            padding: 14px 22px 14px 14px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12), 0 2px 8px rgba(0, 0, 0, 0.08);
            position: relative;
            transition: all 0.25s ease;
            margin-top: 8px;
            max-width: 320px;
        }

        .why-card:first-child { margin-top: 0; }
        .why-card:nth-child(1) { margin-left: 0; z-index: 4; }
        .why-card:nth-child(2) { margin-left: 35px; z-index: 3; }
        .why-card:nth-child(3) { margin-left: 15px; z-index: 2; }
        .why-card:nth-child(4) { margin-left: 50px; z-index: 1; }

        .why-card:hover {
            transform: translateY(-2px) translateX(6px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.18), 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .why-card .why-num {
            width: 38px;
            height: 38px;
            background: linear-gradient(145deg, #0f4c3a, #0a3d2f);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: #fff;
            font-weight: 700;
            flex-shrink: 0;
            box-shadow: 0 3px 8px rgba(15, 76, 58, 0.3);
        }

        .why-card .why-text {
            font-size: 14px;
            font-weight: 700;
            color: #1a1a1a;
            line-height: 1.3;
        }

        .why-card .why-text span {
            display: block;
            font-size: 12px;
            font-weight: 400;
            color: #777;
            margin-top: 3px;
        }

        .example-card {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 14px;
            padding: 24px 28px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .example-card h3 {
            font-size: 14px;
            color: #0f4c3a;
            font-weight: 700;
            margin-bottom: 18px;
            font-family: 'Inter', sans-serif;
            padding-bottom: 12px;
            border-bottom: 2px solid #d4af37;
        }

        .example-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.06);
        }

        .example-row:last-child {
            border-bottom: none;
            padding-top: 14px;
            margin-top: 6px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            background: rgba(15, 76, 58, 0.06);
            margin-left: -28px;
            margin-right: -28px;
            margin-bottom: -24px;
            padding: 16px 28px;
            border-radius: 0 0 14px 14px;
        }

        .example-row .label {
            font-size: 14px;
            color: #555;
        }

        .example-row .value {
            font-size: 15px;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
        }

        .example-row .value.negative { color: #c53030; }
        .example-row .value.positive { color: #1a7a5e; }

        .example-row:last-child .label {
            font-weight: 700;
            color: #0f4c3a;
            font-size: 15px;
        }

        .example-row:last-child .value {
            font-size: 20px;
            font-weight: 800;
            color: #0f4c3a;
        }

        /* Path B DFY Slide */
        .slide-dfy-b {
            background: radial-gradient(ellipse at 30% 40%, #0f4c3a 0%, #0a3d2f 60%, #072820 100%);
            display: flex;
            flex-direction: column;
            padding: 45px 55px;
            position: relative;
            overflow: hidden;
        }

        .slide-dfy-b .header {
            margin-bottom: 30px;
        }

        .dfy-centered {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .dfy-card-large {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 20px;
            padding: 50px 60px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 700px;
            width: 100%;
        }

        .dfy-card-large h3 {
            font-size: 32px;
            color: #0f4c3a;
            font-weight: 700;
            margin-bottom: 10px;
            font-family: 'Playfair Display', serif;
        }

        .dfy-card-large .dfy-subtitle {
            font-size: 18px;
            color: #666;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #d4af37;
        }

        .dfy-list-large {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 22px;
        }

        .dfy-list-large li {
            display: flex;
            align-items: center;
            gap: 18px;
            font-size: 20px;
            color: #333;
            line-height: 1.4;
        }

        .dfy-list-large li .check-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #0f4c3a, #1a7a5e);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 16px;
            flex-shrink: 0;
        }

        /* Path B Features Slide */
        .slide-features {
            background: radial-gradient(ellipse at 30% 40%, #0f4c3a 0%, #0a3d2f 60%, #072820 100%);
            display: flex;
            flex-direction: column;
            padding: 35px 45px;
            position: relative;
            overflow: hidden;
        }

        .slide-features .header {
            margin-bottom: 20px;
        }

        .slide-features .header-badge {
            width: 38px;
            height: 38px;
            font-size: 16px;
        }

        .slide-features .header h1 {
            font-size: 32px;
        }

        .features-fullwidth {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 14px;
            flex: 1;
        }

        .feature-card-large {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 14px;
            padding: 18px 16px;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .feature-card-large:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.25);
        }

        .feature-card-large .card-content h3 {
            font-size: 15px;
            color: #0f4c3a;
            font-weight: 700;
            margin-bottom: 4px;
            font-family: 'Inter', sans-serif;
        }

        .feature-card-large .card-content p {
            font-size: 12px;
            color: #666;
            line-height: 1.4;
        }

        /* Image containers for feature cards */
        .feature-card-large .card-image {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0;
            transform: scale(0.95);
            transition: opacity 0.4s ease, transform 0.4s ease;
            z-index: 10;
        }

        .feature-card-large .card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 14px;
        }

        .feature-card-large .card-image.animate-visible {
            opacity: 1;
            transform: scale(1);
        }

        .feature-card-large .card-image .overlay-title {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.7));
            color: white;
            padding: 20px 15px 12px;
            font-size: 13px;
            font-weight: 600;
            border-radius: 0 0 14px 14px;
        }

        /* Path B Services Slide */
        .slide-services {
            background: radial-gradient(ellipse at 50% 0%, #0f4c3a 0%, #0a3d2f 40%, #072820 100%);
            padding: 45px 55px;
            display: flex;
            flex-direction: column;
        }

        .slide-services .header {
            text-align: center;
            margin-bottom: 35px;
            flex-direction: column;
        }

        .slide-services .path-badge-inline {
            display: inline-block;
            background: linear-gradient(135deg, #d4af37, #b8962e);
            color: #1a1a1a;
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            padding: 6px 14px;
            border-radius: 20px;
            margin-bottom: 14px;
        }

        .slide-services .header h1 {
            font-size: 46px;
            color: #fff;
            font-weight: 500;
        }

        .service-cards-3col {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 22px;
            flex: 1;
        }

        .service-card {
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.97) 0%, rgba(255, 255, 255, 0.92) 100%);
            border-radius: 18px;
            padding: 28px 24px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.25);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .service-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #d4af37, #e8c959);
        }

        .service-card::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, rgba(212, 175, 55, 0.08) 0%, transparent 70%);
        }

        .service-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 18px 50px rgba(0, 0, 0, 0.3);
        }

        .service-card .card-num {
            font-size: 56px;
            font-weight: 800;
            color: #d4af37;
            line-height: 1;
            margin-bottom: 12px;
            font-family: 'Playfair Display', serif;
        }

        .service-card .card-title {
            font-size: 18px;
            color: #0f4c3a;
            font-weight: 700;
            margin-bottom: 16px;
            font-family: 'Inter', sans-serif;
            line-height: 1.3;
            padding-bottom: 14px;
            border-bottom: 2px solid rgba(15, 76, 58, 0.15);
        }

        .service-card .card-bullets {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 12px;
            flex: 1;
        }

        .service-card .card-bullets li {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            font-size: 13px;
            color: #444;
            line-height: 1.45;
        }

        .service-card .card-bullets li::before {
            content: '';
            width: 6px;
            height: 6px;
            background: linear-gradient(135deg, #0f4c3a, #1a7a5e);
            border-radius: 50%;
            flex-shrink: 0;
            margin-top: 6px;
        }

        /* ========================================
           PATH C STYLES
           ======================================== */
        .slide-process {
            background: radial-gradient(ellipse at center, var(--dark-green) 0%, var(--dark-green-mid) 50%, var(--dark-green-deep) 100%);
            padding: 45px 55px;
            display: flex;
            flex-direction: column;
        }

        .slide-process .header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 8px;
        }

        .slide-process .header h1 {
            font-size: 38px;
            color: #fff;
            font-weight: 500;
        }

        .slide-process .subtitle {
            color: rgba(255, 255, 255, 0.6);
            font-size: 15px;
            margin-bottom: 28px;
            margin-left: 58px;
        }

        .why-section-horizontal {
            margin-top: 20px;
        }

        .why-section-horizontal .eyebrow {
            color: var(--gold);
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-bottom: 18px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .why-section-horizontal .eyebrow::before {
            content: '';
            width: 35px;
            height: 2px;
            background: var(--gold);
        }

        .why-cards-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .why-card-horizontal {
            display: flex;
            align-items: center;
            gap: 14px;
            background: #fff;
            border-radius: 14px;
            padding: 18px 22px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12), 0 2px 8px rgba(0, 0, 0, 0.08);
            transition: all 0.25s ease;
        }

        .why-card-horizontal:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.18), 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .why-card-horizontal .why-num {
            width: 42px;
            height: 42px;
            background: linear-gradient(145deg, var(--dark-green), var(--dark-green-mid));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #fff;
            font-weight: 700;
            flex-shrink: 0;
            box-shadow: 0 3px 8px rgba(15, 76, 58, 0.3);
        }

        .why-card-horizontal .why-text {
            font-size: 15px;
            font-weight: 700;
            color: var(--near-black);
            line-height: 1.3;
        }

        .why-card-horizontal .why-text span {
            display: block;
            font-size: 12px;
            font-weight: 400;
            color: #777;
            margin-top: 3px;
        }

        /* Math V2 Slide */
        .slide-math-v2 {
            background: radial-gradient(ellipse at center, var(--dark-green) 0%, var(--dark-green-mid) 50%, var(--dark-green-deep) 100%);
            padding: 45px 55px;
            display: flex;
            flex-direction: column;
        }

        .math-v2-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 10px;
        }

        .math-v2-badge {
            width: 42px;
            height: 42px;
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--dark-green-deep);
            font-weight: 800;
            font-size: 18px;
        }

        .slide-math-v2 h1 {
            font-size: 38px;
            color: #fff;
            font-weight: 500;
        }

        .math-v2-subtitle {
            font-size: 15px;
            color: rgba(255,255,255,0.6);
            margin-bottom: 28px;
            margin-left: 58px;
        }

        .math-v2-subtitle .highlight {
            color: var(--gold);
            font-weight: 600;
        }

        .math-v2-cards {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 24px;
        }

        .math-v2-card {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 14px;
            padding: 24px 28px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }

        .math-v2-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--gold), #e8c959);
        }

        .math-v2-card h3 {
            font-family: 'Inter', sans-serif;
            font-size: 17px;
            font-weight: 700;
            color: var(--dark-green);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(15, 76, 58, 0.12);
        }

        .math-v2-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
        }

        .math-v2-row .label {
            font-size: 14px;
            color: #555;
        }

        .math-v2-row .value {
            font-size: 15px;
            font-weight: 600;
            color: var(--dark-green);
        }

        .math-v2-row .value.positive { color: #0a8a5c; }
        .math-v2-row .value.negative { color: var(--red); }
        .math-v2-row .value.gold { color: var(--gold); }

        .math-v2-row.total .label {
            font-weight: 700;
            color: var(--dark-green);
        }

        .math-v2-row.total .value {
            font-size: 17px;
            font-weight: 700;
        }

        .math-v2-divider {
            height: 2px;
            background: linear-gradient(90deg, var(--gold), transparent);
            margin: 6px 0;
        }

        .math-v2-total {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 14px;
            padding: 28px 35px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
            max-width: 600px;
            margin: 0 auto;
        }

        .math-v2-total::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--gold), #e8c959);
        }

        .math-v2-total .total-label {
            font-size: 11px;
            font-weight: 700;
            color: var(--dark-green);
            letter-spacing: 2px;
            text-transform: uppercase;
            display: block;
            margin-bottom: 10px;
        }

        .math-v2-total .total-amount {
            font-family: 'Playfair Display', serif;
            font-size: 58px;
            font-weight: 500;
            color: var(--gold);
            line-height: 1;
            margin-bottom: 10px;
        }

        .math-v2-total .total-amount .currency {
            font-size: 28px;
            vertical-align: super;
            margin-right: 2px;
        }

        .math-v2-total .total-breakdown {
            font-size: 13px;
            color: #666;
        }

        /* Built For You Slide */
        .slide-built-for {
            background: radial-gradient(ellipse at center, var(--dark-green-mid) 0%, var(--dark-green-deep) 60%, #051a14 100%);
            padding: 55px 65px;
            display: flex;
            flex-direction: column;
        }

        .slide-built-for .header {
            text-align: center;
            margin-bottom: 45px;
        }

        .slide-built-for .header h1 {
            font-size: 52px;
            color: #fff;
            font-weight: 500;
        }

        .qualification-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: var(--dark-green-deep);
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            padding: 6px 14px;
            border-radius: 20px;
            margin-bottom: 12px;
        }

        .featured-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .featured-card {
            background: rgba(255, 255, 255, 0.97);
            border: 2px solid rgba(212, 175, 55, 0.5);
            border-radius: 16px;
            padding: 28px 26px;
            display: flex;
            align-items: flex-start;
            gap: 16px;
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.22), 0 0 20px rgba(212, 175, 55, 0.15);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .featured-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--gold), #e8c959);
        }

        .featured-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 18px 45px rgba(0, 0, 0, 0.28), 0 0 25px rgba(212, 175, 55, 0.2);
        }

        .featured-card .check-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--dark-green-deep);
            font-size: 18px;
            font-weight: 700;
            flex-shrink: 0;
        }

        .featured-card p {
            font-size: 16px;
            color: var(--dark-green);
            font-weight: 600;
            line-height: 1.5;
        }

        .featured-card p .highlight {
            color: var(--gold);
            font-weight: 700;
        }

        .standard-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .standard-card {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 14px;
            padding: 20px 22px;
            display: flex;
            align-items: flex-start;
            gap: 14px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.18);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .standard-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--light-green), #3dd9a0);
        }

        .standard-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.22);
        }

        .standard-card .check-icon {
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, var(--light-green), var(--dark-green));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 14px;
            font-weight: 700;
            flex-shrink: 0;
        }

        .standard-card p {
            font-size: 14px;
            color: #444;
            line-height: 1.45;
        }

        .standard-card p .highlight {
            color: var(--dark-green);
            font-weight: 600;
        }

        /* Path Combined Slide */
        .slide-path-combined {
            background: radial-gradient(ellipse at center, var(--dark-green) 0%, var(--dark-green-mid) 50%, var(--dark-green-deep) 100%);
            display: grid;
            grid-template-columns: 0.9fr 1.1fr;
            padding: 40px 55px;
            gap: 40px;
        }

        .combined-left {
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .combined-left .path-badge {
            display: inline-flex;
            align-items: center;
            gap: 14px;
            margin-bottom: 16px;
        }

        .combined-left .path-badge .circle {
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--dark-green-deep);
            font-weight: 800;
            font-size: 18px;
        }

        .combined-left .path-badge .label {
            color: rgba(255,255,255,0.5);
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 3px;
            text-transform: uppercase;
        }

        .combined-left h1 {
            font-size: 38px;
            color: #fff;
            line-height: 1.15;
            margin-bottom: 14px;
            font-weight: 500;
        }

        .combined-left .subtitle {
            font-size: 14px;
            color: rgba(255,255,255,0.6);
            line-height: 1.55;
            margin-bottom: 28px;
        }

        .combined-benefit-card {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 10px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 10px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            position: relative;
            overflow: hidden;
            max-width: 320px;
        }

        .combined-benefit-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--gold), #e8c959);
        }

        .combined-benefit-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: var(--dark-green-deep);
            flex-shrink: 0;
        }

        .combined-benefit-content h3 {
            font-family: 'Inter', sans-serif;
            font-size: 13px;
            font-weight: 700;
            color: var(--dark-green);
            margin-bottom: 2px;
        }

        .combined-benefit-content p {
            font-size: 11px;
            color: #666;
        }

        .combined-right {
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .combined-comparison-header {
            margin-bottom: 20px;
        }

        .combined-comparison-header h2 {
            font-size: 26px;
            color: #fff;
            line-height: 1.15;
            font-weight: 500;
        }

        .combined-comparison-header h2 .green {
            color: var(--gold);
        }

        .combined-comparison-items {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 14px;
        }

        .combined-comparison-item {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 12px;
            padding: 18px 16px 14px;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 28px rgba(0, 0, 0, 0.2);
        }

        .combined-comparison-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #999, #bbb);
        }

        .combined-comparison-item .amount {
            font-family: 'Playfair Display', serif;
            font-size: 32px;
            font-weight: 500;
            color: var(--dark-green);
            line-height: 1;
            margin-bottom: 6px;
        }

        .combined-comparison-item h4 {
            font-size: 13px;
            color: var(--dark-green);
            font-weight: 600;
            margin-bottom: 2px;
            font-family: 'Inter', sans-serif;
        }

        .combined-comparison-item .period {
            font-size: 10px;
            color: #888;
            margin-bottom: 10px;
        }

        .combined-comparison-item .tag {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 10px;
            font-weight: 700;
            padding: 6px 10px;
            border-radius: 6px;
            width: fit-content;
        }

        .combined-comparison-item .tag.negative {
            background: rgba(197, 48, 48, 0.08);
            color: var(--red);
            border: 1px solid rgba(197, 48, 48, 0.2);
        }

        .combined-comparison-item .tag.negative::before {
            content: '✕';
            font-size: 8px;
        }

        .combined-comparison-item .tag.positive {
            background: rgba(26, 122, 94, 0.1);
            color: var(--dark-green);
            border: 1px solid rgba(26, 122, 94, 0.25);
        }

        .combined-comparison-item .tag.positive::before {
            content: '✓';
            font-size: 10px;
            font-weight: 800;
        }

        .combined-comparison-item .tags-row {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .combined-comparison-item.featured {
            border: 2px solid rgba(212, 175, 55, 0.5);
            box-shadow: 0 10px 32px rgba(0, 0, 0, 0.22), 0 0 15px rgba(212, 175, 55, 0.15);
        }

        .combined-comparison-item.featured::before {
            background: linear-gradient(90deg, var(--gold), #e8c959);
        }

        .combined-comparison-item.featured .amount {
            color: var(--gold);
        }

        /* STR Concierge Slide */
        .slide-dfy-c {
            background: radial-gradient(ellipse at 30% 70%, #0f4c3a 0%, #0a3d2f 40%, #072820 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 60px 80px;
            position: relative;
            overflow: hidden;
        }

        .dfy-eyebrow {
            color: var(--gold);
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 4px;
            text-transform: uppercase;
            margin-bottom: 28px;
        }

        .slide-dfy-c h1 {
            font-size: 68px;
            color: #fff;
            line-height: 1.1;
            margin-bottom: 28px;
            font-weight: 500;
        }

        .dfy-tagline {
            font-family: 'Playfair Display', serif;
            font-size: 20px;
            font-style: italic;
            color: rgba(255,255,255,0.6);
            margin-bottom: 45px;
            line-height: 1.5;
        }

        .dfy-box {
            background: rgba(26, 122, 94, 0.25);
            border: 1px solid rgba(26, 122, 94, 0.4);
            border-radius: 12px;
            padding: 28px 45px;
            max-width: 680px;
        }

        .dfy-box p {
            font-size: 16px;
            color: rgba(255,255,255,0.75);
            line-height: 1.7;
        }

        .dfy-box .highlight {
            color: var(--gold);
            font-weight: 600;
        }

        .scarcity-note {
            display: flex;
            align-items: center;
            gap: 24px;
            background: rgba(7, 40, 32, 0.5);
            border: 2px solid var(--gold);
            border-radius: 16px;
            padding: 24px 32px;
            margin-top: 40px;
            max-width: 420px;
        }

        .scarcity-number {
            font-family: 'Playfair Display', serif;
            font-size: 64px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--gold), #e8c959);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
        }

        .scarcity-text {
            text-align: left;
        }

        .scarcity-headline {
            font-size: 18px;
            font-weight: 700;
            color: #fff;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .scarcity-reason {
            font-size: 14px;
            color: rgba(255,255,255,0.8);
            line-height: 1.5;
        }

        /* Buying Lane Slide */
        .slide-buying-lane {
            background: radial-gradient(ellipse at 50% 0%, var(--dark-green) 0%, var(--dark-green-mid) 40%, var(--dark-green-deep) 100%);
            padding: 45px 55px;
            display: flex;
            flex-direction: column;
        }

        .slide-buying-lane .header {
            text-align: center;
            margin-bottom: 35px;
        }

        .slide-buying-lane .path-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: var(--dark-green-deep);
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            padding: 6px 14px;
            border-radius: 20px;
            margin-bottom: 14px;
        }

        .slide-buying-lane .header h1 {
            font-size: 46px;
            color: #fff;
            font-weight: 500;
        }

        .service-cards-2col {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 22px;
            flex: 1;
        }

        .service-card .card-subtitle {
            font-size: 13px;
            color: #666;
            margin-bottom: 16px;
        }

        .service-card .timeline-tag {
            display: inline-block;
            margin-top: 18px;
            padding: 10px 16px;
            background: rgba(15, 76, 58, 0.08);
            border-radius: 8px;
            font-size: 12px;
            color: var(--dark-green);
            font-weight: 600;
        }

        /* Tax Optimized Slide */
        .slide-tax-optimized {
            background: radial-gradient(ellipse at center, var(--dark-green-mid) 0%, var(--dark-green-deep) 60%, #051a14 100%);
            padding: 55px 65px;
            display: flex;
            flex-direction: column;
        }

        .slide-tax-optimized .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .slide-tax-optimized .header h1 {
            font-size: 52px;
            color: #fff;
            font-weight: 500;
            margin-bottom: 16px;
        }

        .slide-tax-optimized .header .subtitle {
            font-size: 17px;
            color: rgba(255,255,255,0.6);
        }

        .slide-tax-optimized .header .subtitle .highlight {
            color: var(--gold);
            font-weight: 500;
        }

        .tax-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            flex: 1;
        }

        .tax-column {
            display: flex;
            flex-direction: column;
        }

        .tax-column-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .tax-column-header .header-line {
            width: 35px;
            height: 3px;
            border-radius: 2px;
        }

        .tax-column-header .header-line.gold {
            background: linear-gradient(90deg, var(--gold), #e8c959);
        }

        .tax-column-header .header-line.green {
            background: linear-gradient(90deg, var(--light-green), #3dd9a0);
        }

        .tax-column-header h3 {
            font-family: 'Inter', sans-serif;
            font-size: 12px;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .tax-column-header h3.gold { color: var(--gold); }
        .tax-column-header h3.green { color: #3dd9a0; }

        .tax-column-cards {
            display: flex;
            flex-direction: column;
            gap: 14px;
        }

        .tax-card-white {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 14px;
            padding: 22px 24px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .tax-card-white::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
        }

        .tax-card-white.gold-accent::before {
            background: linear-gradient(90deg, var(--gold), #e8c959);
        }

        .tax-card-white.green-accent::before {
            background: linear-gradient(90deg, var(--light-green), #3dd9a0);
        }

        .tax-card-white:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.25);
        }

        .tax-card-white .card-header {
            display: flex;
            align-items: center;
            gap: 14px;
            margin-bottom: 10px;
        }

        .tax-icon-box {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            flex-shrink: 0;
        }

        .tax-icon-box.gold {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: var(--dark-green-deep);
        }

        .tax-icon-box.green {
            background: linear-gradient(135deg, var(--light-green), var(--dark-green));
            color: #fff;
        }

        .tax-card-white h4 {
            font-family: 'Inter', sans-serif;
            font-size: 15px;
            font-weight: 700;
            color: var(--dark-green);
            line-height: 1.3;
        }

        .tax-card-white p {
            font-size: 13px;
            color: #666;
            line-height: 1.45;
            margin-left: 58px;
        }

        /* Setup Slide */
        .slide-setup {
            background: radial-gradient(ellipse at center, var(--dark-green-mid) 0%, var(--dark-green-deep) 60%, #051a14 100%);
            padding: 40px 55px;
            display: flex;
            flex-direction: column;
        }

        .slide-setup .header {
            text-align: center;
            margin-bottom: 22px;
        }

        .slide-setup .header h1 {
            font-size: 42px;
            color: #fff;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .slide-setup .header .subtitle {
            font-size: 14px;
            color: rgba(255,255,255,0.55);
        }

        .setup-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: var(--dark-green-deep);
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            padding: 6px 14px;
            border-radius: 20px;
            margin-bottom: 12px;
        }

        .setup-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            flex: 1;
        }

        .setup-card-white {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 14px;
            padding: 18px 22px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.22);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .setup-card-white::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--gold), #e8c959);
        }

        .setup-card-white::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, rgba(212, 175, 55, 0.1) 0%, transparent 70%);
        }

        .setup-card-white:hover {
            transform: translateY(-3px);
            box-shadow: 0 14px 38px rgba(0, 0, 0, 0.26);
        }

        .setup-card-white .card-number {
            font-family: 'Playfair Display', serif;
            font-size: 36px;
            font-weight: 600;
            color: var(--gold);
            line-height: 1;
            margin-bottom: 4px;
        }

        .setup-card-white .card-category {
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            font-weight: 700;
            color: var(--dark-green);
            margin-bottom: 12px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(15, 76, 58, 0.12);
        }

        .setup-card-white ul {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 7px;
        }

        .setup-card-white ul li {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            font-weight: 500;
            color: #333;
            line-height: 1.4;
        }

        .setup-card-white ul li::before {
            content: '';
            width: 7px;
            height: 7px;
            background: linear-gradient(135deg, var(--dark-green), var(--light-green));
            border-radius: 50%;
            flex-shrink: 0;
        }

        /* Referrals Slide */
        .slide-referrals {
            background: radial-gradient(ellipse at center, var(--dark-green-mid) 0%, var(--dark-green-deep) 60%, #051a14 100%);
            padding: 55px 65px;
            display: flex;
            flex-direction: column;
        }

        .slide-referrals .header {
            text-align: center;
            margin-bottom: 45px;
        }

        .slide-referrals .header h1 {
            font-size: 50px;
            color: #fff;
            font-weight: 500;
            margin-bottom: 14px;
        }

        .slide-referrals .header .subtitle {
            font-size: 16px;
            color: rgba(255,255,255,0.55);
        }

        .slide-referrals .header .subtitle .highlight {
            color: var(--gold);
            font-weight: 500;
        }

        .network-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: var(--dark-green-deep);
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            padding: 6px 14px;
            border-radius: 20px;
            margin-bottom: 12px;
        }

        .referral-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            flex: 1;
        }

        .referral-card-white {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 16px;
            padding: 28px 22px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .referral-card-white::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--gold), #e8c959);
        }

        .referral-card-white:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.25);
        }

        .referral-icon-box {
            width: 56px;
            height: 56px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .referral-icon-box.gold {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: var(--dark-green-deep);
        }

        .referral-icon-box.green {
            background: linear-gradient(135deg, var(--light-green), var(--dark-green));
            color: #fff;
        }

        .referral-card-white h3 {
            font-family: 'Inter', sans-serif;
            font-size: 15px;
            font-weight: 700;
            color: var(--dark-green);
            margin-bottom: 8px;
        }

        .referral-card-white p {
            font-size: 13px;
            color: #666;
            line-height: 1.4;
        }

        /* Decision Slide */
        .slide-decision {
            background: radial-gradient(ellipse at center, var(--dark-green) 0%, var(--dark-green-mid) 50%, var(--dark-green-deep) 100%);
            padding: 35px 55px;
            display: flex;
            flex-direction: column;
        }

        .decision-header {
            text-align: center;
            margin-bottom: 15px;
        }

        .decision-eyebrow {
            color: var(--gold);
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 3px;
            text-transform: uppercase;
            display: block;
            margin-bottom: 8px;
        }

        .decision-header h1 {
            font-size: 42px;
            color: #fff;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .decision-subtitle {
            font-size: 14px;
            color: rgba(255,255,255,0.6);
            line-height: 1.4;
        }

        .flowchart-centered {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
        }

        .flowchart-box-full {
            background: transparent;
            border: none;
            padding: 24px 35px 30px;
            max-width: 780px;
            width: 100%;
        }

        .flow-node {
            border-radius: 10px;
            padding: 10px 18px;
            text-align: center;
            margin: 0 auto;
        }

        .flow-node.flow-start {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            max-width: 320px;
            box-shadow: 0 4px 20px rgba(212, 175, 55, 0.3);
        }

        .flow-node.flow-start .flow-node-title {
            color: var(--dark-green-deep);
        }

        .flow-node.flow-start .flow-node-subtitle {
            color: rgba(7, 40, 32, 0.7);
        }

        .flow-node-title {
            color: #fff;
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 2px;
        }

        .flow-node-subtitle {
            color: rgba(255,255,255,0.6);
            font-size: 12px;
        }

        .flow-arrow {
            text-align: center;
            color: rgba(255,255,255,0.5);
            font-size: 18px;
            margin: 8px 0;
            font-weight: 300;
        }

        .flow-arrow-small {
            text-align: center;
            color: rgba(255,255,255,0.5);
            font-size: 16px;
            margin: 5px 0;
        }

        .flow-node.flow-question {
            background: rgba(255, 255, 255, 0.95);
            max-width: 320px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
        }

        .flow-node.flow-question span {
            color: var(--dark-green);
            font-size: 13px;
            font-weight: 600;
        }

        .flow-node.flow-question.small {
            padding: 8px 12px;
            max-width: 180px;
        }

        .flow-node.flow-question.small span {
            font-size: 11px;
        }

        .flow-branch-main {
            display: flex;
            justify-content: center;
            gap: 50px;
            margin-top: 8px;
        }

        .flow-branch-left,
        .flow-branch-right {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .flow-branch-inner {
            display: flex;
            gap: 15px;
            margin-top: 6px;
        }

        .branch-label {
            font-size: 11px;
            font-weight: 700;
            margin-bottom: 3px;
            padding: 2px 8px;
            border-radius: 4px;
        }

        .branch-label.yes {
            color: var(--gold);
            background: rgba(212, 175, 55, 0.15);
        }

        .branch-label.no {
            color: rgba(255,255,255,0.6);
            background: rgba(255,255,255,0.05);
        }

        .flow-node.flow-path {
            padding: 10px 16px;
            min-width: 110px;
        }

        .flow-node.flow-path.path-a {
            background: linear-gradient(135deg, var(--light-green), var(--dark-green));
            box-shadow: 0 4px 16px rgba(26, 122, 94, 0.35);
        }

        .flow-node.flow-path.path-b {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            box-shadow: 0 4px 16px rgba(212, 175, 55, 0.35);
        }

        .flow-node.flow-path.path-c {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            box-shadow: 0 4px 16px rgba(212, 175, 55, 0.35);
        }

        .flow-node.flow-path .path-label {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 2px;
        }

        .flow-node.flow-path.path-a .path-label {
            color: #fff;
        }

        .flow-node.flow-path.path-b .path-label,
        .flow-node.flow-path.path-c .path-label {
            color: var(--dark-green-deep);
        }

        .flow-node.flow-path .path-desc {
            font-size: 10px;
        }

        .flow-node.flow-path.path-a .path-desc {
            color: rgba(255,255,255,0.8);
        }

        .flow-node.flow-path.path-b .path-desc,
        .flow-node.flow-path.path-c .path-desc {
            color: rgba(7, 40, 32, 0.7);
        }

        /* Comparison Table Slide */
        .slide-comparison-table {
            background: radial-gradient(ellipse at center, var(--dark-green) 0%, var(--dark-green-mid) 50%, var(--dark-green-deep) 100%);
            padding: 32px 50px 28px;
            display: flex;
            flex-direction: column;
        }

        .comparison-table-header {
            text-align: center;
            margin-bottom: 18px;
        }

        .comparison-eyebrow {
            color: var(--gold);
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 3px;
            text-transform: uppercase;
            display: block;
            margin-bottom: 8px;
        }

        .comparison-table-header h1 {
            font-size: 38px;
            color: #fff;
            font-weight: 500;
        }

        .comparison-table-centered {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            flex: 1;
        }

        .comparison-columns-wrapper {
            display: flex;
            gap: 16px;
            width: 100%;
            max-width: 1000px;
        }

        .factor-labels-col {
            display: flex;
            flex-direction: column;
            padding-top: 90px;
            width: 160px;
            flex-shrink: 0;
        }

        .factor-label-item {
            height: 48px;
            display: flex;
            align-items: center;
            color: rgba(255,255,255,0.5);
            font-size: 13px;
            font-weight: 500;
        }

        .factor-label-item:nth-child(6) {
            height: 72px;
        }

        .path-column {
            flex: 1;
            background: rgba(255,255,255,0.97);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .path-column:hover {
            transform: translateY(-4px);
            box-shadow: 0 14px 38px rgba(0,0,0,0.26);
        }

        .path-column.featured {
            border: 2px solid var(--light-green);
            box-shadow: 0 0 30px rgba(26, 122, 94, 0.25), 0 12px 35px rgba(0,0,0,0.22);
            transform: scale(1.03);
            position: relative;
        }

        .path-column.featured:hover {
            transform: scale(1.03) translateY(-4px);
        }

        .path-column-header {
            padding: 18px 16px 14px;
            text-align: center;
            position: relative;
            background: linear-gradient(135deg, var(--light-green), var(--dark-green));
            min-height: 90px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            box-sizing: border-box;
        }

        .spots-badge {
            position: absolute;
            top: -1px;
            left: 50%;
            transform: translateX(-50%);
            background: #fff;
            color: var(--dark-green);
            font-size: 8px;
            font-weight: 800;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            padding: 4px 12px;
            border-radius: 0 0 8px 8px;
        }

        .path-letter {
            font-family: 'Playfair Display', serif;
            font-size: 36px;
            font-weight: 600;
            color: #fff;
            line-height: 1;
            margin-bottom: 4px;
        }

        .path-name {
            font-size: 11px;
            color: rgba(255,255,255,0.8);
            font-weight: 500;
            line-height: 1.3;
        }

        .path-column.featured .path-name {
            color: rgba(255,255,255,0.9);
            font-weight: 600;
        }

        .path-values {
            display: flex;
            flex-direction: column;
        }

        .path-value-item {
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: #444;
            border-top: 1px solid rgba(0,0,0,0.06);
            padding: 0 12px;
            text-align: center;
        }

        .path-value-item.highlight-green {
            color: #0a8a5c;
            font-weight: 700;
        }

        .path-value-item.highlight-gold {
            color: #0a8a5c;
            font-weight: 700;
        }

        .path-value-item .check-yes {
            color: #0a8a5c;
            font-weight: 800;
            font-size: 16px;
        }

        .path-value-item .check-no {
            color: rgba(0,0,0,0.25);
        }

        .path-value-item.best-for {
            font-size: 11px;
            line-height: 1.4;
            color: var(--dark-green);
            font-weight: 500;
            padding: 12px 10px;
            height: 72px;
        }

        .path-column.featured .path-value-item.best-for {
            font-weight: 600;
        }

        /* Save indicator styles (kept for localStorage feedback) */
        .save-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #4ade80;
            color: #1a1a1a;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1001;
            font-family: 'Inter', sans-serif;
        }

        .save-indicator.show {
            opacity: 1;
        }

        /* Collapsible toolbar for persistence features */
        .toolbar {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 1001;
        }
        .toolbar-toggle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #333;
            color: #fff;
            border: none;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s, background 0.2s;
        }
        .toolbar-toggle:hover { background: #444; }
        .toolbar.open .toolbar-toggle { transform: rotate(45deg); }
        .toolbar-menu {
            position: absolute;
            bottom: 50px;
            left: 0;
            display: flex;
            flex-direction: column;
            gap: 8px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px);
            transition: opacity 0.2s, transform 0.2s, visibility 0.2s;
        }
        .toolbar.open .toolbar-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        .toolbar-menu button {
            background: #d4af37;
            color: #1a1a1a;
            border: none;
            padding: 10px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
            white-space: nowrap;
        }
        .toolbar-menu button:hover { background: #e8c959; }
        .toolbar-menu button.btn-secondary { background: #333; color: #fff; }
        .toolbar-menu button.btn-secondary:hover { background: #444; }
        .hidden-input { display: none; }

        /* ========================================
           THE ROI SLIDE STYLES
           ======================================== */
        .slide-roi {
            background: #fff;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .slide-roi .roi-top-bar {
            background: linear-gradient(90deg, #0a3d2f, #0f4c3a);
            height: 14px;
            width: 100%;
        }

        .slide-roi .roi-content {
            flex: 1;
            padding: 45px 70px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .slide-roi .roi-title {
            font-family: 'Playfair Display', serif;
            font-size: 72px;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 8px;
            text-align: center;
            letter-spacing: -1px;
        }

        .slide-roi .roi-chevrons {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0;
            margin-bottom: 35px;
        }

        .slide-roi .roi-chevron {
            color: #d4af37;
            font-size: 28px;
            line-height: 0.6;
        }

        .slide-roi .roi-points {
            width: 100%;
            max-width: 950px;
            margin-bottom: 40px;
        }

        .slide-roi .roi-point {
            display: flex;
            align-items: flex-start;
            gap: 14px;
            margin-bottom: 18px;
            font-size: 26px;
            color: #1a1a1a;
            line-height: 1.45;
        }

        .slide-roi .roi-point .roi-icon {
            font-size: 28px;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .slide-roi .roi-point .underline {
            text-decoration: underline;
        }

        .slide-roi .roi-point .highlight-yellow {
            background: #ffff00;
            padding: 2px 6px;
            font-weight: 700;
        }

        .slide-roi .roi-point .bold {
            font-weight: 700;
        }

        .slide-roi .roi-image-container {
            width: 100%;
            max-width: 820px;
            margin: 0 auto;
        }

        .slide-roi .roi-image-container img {
            width: 100%;
            height: auto;
            display: block;
        }

        .slide-roi .roi-footer {
            background: linear-gradient(90deg, #0a3d2f, #0f4c3a);
            padding: 18px 50px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: auto;
        }

        .slide-roi .roi-footer-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .slide-roi .roi-footer .goto-text {
            color: #fff;
            font-size: 28px;
            font-weight: 800;
            font-family: 'Inter', sans-serif;
            letter-spacing: 2px;
        }

        .slide-roi .roi-footer .goto-url {
            background: #ffd700;
            color: #1a1a1a;
            font-size: 28px;
            font-weight: 800;
            font-family: 'Inter', sans-serif;
            padding: 10px 24px;
            letter-spacing: 1px;
        }

        .slide-roi .roi-footer .help-text {
            color: #ffd700;
            font-size: 18px;
            font-weight: 600;
            text-align: right;
            line-height: 1.3;
        }
    </style>
</head>
<body>

    <!-- ========================================
         PATH A SLIDES (1 slide)
         ======================================== -->

    <!-- SLIDE 1: PATH A - Legacy Wealth Blueprint -->
    <div class="slide slide-path-a">
        <div class="whats-included-header">
            <div class="path-eyebrow">PATH A</div>
            <h1>Legacy Wealth Blueprint</h1>
        </div>
        <h2 class="whats-included-h2">What's Included</h2>

        <div class="checklist-floating">
            <div class="floating-item">
                <div class="check-badge">&#10003;</div>
                <span>100+ Video Lessons — Lifetime access</span>
            </div>
            <div class="floating-item">
                <div class="check-badge">&#10003;</div>
                <span>1-on-1 Wealth Guide</span>
            </div>
            <div class="floating-item">
                <div class="check-badge">&#10003;</div>
                <span>Wealth Circle Community (12 Mo.)</span>
            </div>
            <div class="floating-item">
                <div class="check-badge">&#10003;</div>
                <span>Personal AI Wealth Advisor</span>
            </div>
            <div class="floating-item">
                <div class="check-badge">&#10003;</div>
                <span>Weekly Coaching + Replays</span>
            </div>
            <div class="floating-item">
                <div class="check-badge">&#10003;</div>
                <span>SOPs, Templates & Checklists</span>
            </div>
            <div class="floating-item">
                <div class="check-badge">&#10003;</div>
                <span>12-Month Wealth Snapshot</span>
            </div>
            <div class="floating-item">
                <div class="check-badge">&#10003;</div>
                <span>+1 Spouse/Family Membership</span>
            </div>
        </div>

        <div class="curriculum-section">
            <div class="curriculum-header">
                <h2>The Complete Curriculum <span>— Five Pillars</span></h2>
            </div>

            <div class="pillars-grid">
                <div class="pillar-card">
                    <div class="num">01</div>
                    <h3>Tax Optimization</h3>
                    <p>Keep $50K-$200K more yearly with legal loopholes the wealthy use</p>
                </div>
                <div class="pillar-card">
                    <div class="num">02</div>
                    <h3>Debt & Credit Leverage</h3>
                    <p>Unlock 0% financing & $100K+ business credit lines</p>
                </div>
                <div class="pillar-card">
                    <div class="num">03</div>
                    <h3>Income Acceleration</h3>
                    <p>Build $5K-$20K/mo passive income streams on autopilot</p>
                </div>
                <div class="pillar-card">
                    <div class="num">04</div>
                    <h3>Investment Vehicles</h3>
                    <p>Tax-free compounding & backdoor strategies for 7-figure growth</p>
                </div>
                <div class="pillar-card">
                    <div class="num">05</div>
                    <h3>Wealth Protection</h3>
                    <p>Lawsuit-proof your assets & build generational wealth</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ========================================
         PATH B SLIDES (4 slides)
         ======================================== -->

    <!-- SLIDE 2: PATH B - The Airbnb Arbitrage Model -->
    <div class="slide slide-arbitrage-model">
        <div class="header">
            <div class="header-badge">B</div>
            <h1>The Airbnb Arbitrage Model</h1>
        </div>
        <p class="subtitle">How to generate $3K-$10K monthly cash flow without buying property.</p>

        <div class="steps-flow">
            <div class="step-card">
                <div class="num">01</div>
                <h3>Find a Property</h3>
                <p>High-demand area where STRs are allowed</p>
            </div>
            <div class="step-card">
                <div class="num">02</div>
                <h3>Sign a Lease</h3>
                <p>12-month long-term lease with landlord</p>
            </div>
            <div class="step-card">
                <div class="num">03</div>
                <h3>Furnish & List</h3>
                <p>List on Airbnb, VRBO, and Booking.com</p>
            </div>
            <div class="step-card">
                <div class="num">04</div>
                <h3>Generate Cash Flow</h3>
                <p>2-3x your monthly lease cost</p>
            </div>
        </div>

        <div class="bottom-grid">
            <div class="why-section">
                <div class="eyebrow">Why This Works</div>
                <div class="why-stack">
                    <div class="why-card">
                        <div class="why-num">1</div>
                        <div class="why-text">Low Capital Entry <span>Start with $10-25K, no property purchase</span></div>
                    </div>
                    <div class="why-card">
                        <div class="why-num">2</div>
                        <div class="why-text">Fast to Revenue <span>Live and earning in 30-60 days</span></div>
                    </div>
                    <div class="why-card">
                        <div class="why-num">3</div>
                        <div class="why-text">Tax-Free Structure <span>Via self-directed IRA</span></div>
                    </div>
                    <div class="why-card">
                        <div class="why-num">4</div>
                        <div class="why-text">100% Remote & Scalable</div>
                    </div>
                </div>
            </div>

            <div class="example-card">
                <h3>Example Numbers</h3>
                <div class="example-row">
                    <span class="label">Monthly Rent</span>
                    <span class="value negative">-$2,500</span>
                </div>
                <div class="example-row">
                    <span class="label">Monthly Revenue</span>
                    <span class="value positive">$6,500</span>
                </div>
                <div class="example-row">
                    <span class="label">Expenses</span>
                    <span class="value negative">-$1,500</span>
                </div>
                <div class="example-row">
                    <span class="label">Net Profit</span>
                    <span class="value">$2,500/mo</span>
                </div>
            </div>
        </div>
    </div>

    <!-- SLIDE 3: PATH B - Done-For-You Services -->
    <div class="slide slide-dfy-b">
        <div class="header">
            <div class="header-badge">B</div>
            <h1>Everything in Path A, Plus</h1>
        </div>

        <div class="dfy-centered">
            <div class="dfy-card-large">
                <h3>Done-For-You Services</h3>
                <p class="dfy-subtitle">We handle the heavy lifting:</p>
                <ul class="dfy-list-large">
                    <li>
                        <span class="check-icon">✓</span>
                        Property setup & listing design
                    </li>
                    <li>
                        <span class="check-icon">✓</span>
                        Furnishing & interior optimization
                    </li>
                    <li>
                        <span class="check-icon">✓</span>
                        Operations & guest management
                    </li>
                    <li>
                        <span class="check-icon">✓</span>
                        Messaging automation systems
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <!-- SLIDE 4: PATH B - Your Success Toolkit -->
    <div class="slide slide-features">
        <div class="header">
            <div class="header-badge">B</div>
            <h1>Your Success Toolkit</h1>
        </div>

        <div class="features-fullwidth">
            <div class="feature-card-large">
                <div class="card-content">
                    <h3>Dedicated 1-on-1 Coach</h3>
                    <p>Your personal mentor for the Airbnb business</p>
                </div>
                <div class="card-image">
                    <img src="images/image9.png" alt="Video coaching session">
                    <div class="overlay-title">1-1 STR Coach</div>
                </div>
            </div>
            <div class="feature-card-large">
                <div class="card-content">
                    <h3>Airbnb Ascension Curriculum</h3>
                    <p>Complete training on rental arbitrage</p>
                </div>
                <div class="card-image">
                    <img src="images/image4.png" alt="Course platform interface">
                    <div class="overlay-title">Complete Training Platform</div>
                </div>
            </div>
            <div class="feature-card-large">
                <div class="card-content">
                    <h3>Property Profitability Analysis</h3>
                    <p>We analyze deals before you sign</p>
                </div>
                <div class="card-image">
                    <img src="images/property-profitability.png" alt="Property Profitability Report">
                    <div class="overlay-title">Property Profitability Analysis</div>
                </div>
            </div>
            <div class="feature-card-large">
                <div class="card-content">
                    <h3>AirDNA</h3>
                    <p>$14,400 software included for free</p>
                </div>
                <div class="card-image">
                    <img src="images/premium-data-tools.jpeg" alt="AirDNA Dashboard">
                    <div class="overlay-title">AirDNA</div>
                </div>
            </div>
            <div class="feature-card-large">
                <div class="card-content">
                    <h3>Uplisting</h3>
                    <p>All-in-one vacation rental & channel management</p>
                </div>
                <div class="card-image">
                    <img src="images/uplisting.webp" alt="Uplisting Interface">
                    <div class="overlay-title">Uplisting</div>
                </div>
            </div>
            <div class="feature-card-large">
                <div class="card-content">
                    <h3>Market Matrix</h3>
                    <p>Top 500 markets ranked and analyzed</p>
                </div>
                <div class="card-image">
                    <img src="images/image17.png" alt="Market Matrix Map">
                    <div class="overlay-title">Market Matrix</div>
                </div>
            </div>
            <div class="feature-card-large">
                <div class="card-content">
                    <h3>AI Advisor</h3>
                    <p>24/7 intelligent assistant for property decisions</p>
                </div>
                <div class="card-image">
                    <img src="images/ai-advisor.png" alt="AI Advisor Interface">
                    <div class="overlay-title">AI Advisor</div>
                </div>
            </div>
            <div class="feature-card-large">
                <div class="card-content">
                    <h3>Scripts & Templates</h3>
                    <p>Landlord outreach, lease agreements, SOPs</p>
                </div>
                <div class="card-image">
                    <img src="images/image10.png" alt="Scripts & Templates Library">
                    <div class="overlay-title">Scripts & Templates</div>
                </div>
            </div>
        </div>
    </div>

    <!-- SLIDE 5: PATH B - Here's What We Do For You -->
    <div class="slide slide-services">
        <div class="header">
            <div class="path-badge-inline">Path B</div>
            <h1>Here's What We Do For You</h1>
        </div>

        <div class="service-cards-3col">
            <div class="service-card">
                <div class="card-num">01</div>
                <h3 class="card-title">We Help You Acquire the Lease</h3>
                <ul class="card-bullets">
                    <li>Train you on finding profitable markets and properties</li>
                    <li>Provide cold calling scripts and do roleplay practice with you</li>
                    <li>Give you our lease negotiation playbook</li>
                    <li>Your coaches vouch for you with landlords as references</li>
                </ul>
            </div>

            <div class="service-card">
                <div class="card-num">02</div>
                <h3 class="card-title">We Set Up All Operations</h3>
                <ul class="card-bullets">
                    <li>Guide you on design & furnishing for maximum appeal</li>
                    <li>List your property on Airbnb, VRBO, and Booking.com</li>
                    <li>Optimize your listing copy, photos, and positioning</li>
                    <li>Set up your guest communication templates</li>
                </ul>
            </div>

            <div class="service-card">
                <div class="card-num">03</div>
                <h3 class="card-title">We Automate Your Pricing & Systems</h3>
                <ul class="card-bullets">
                    <li>Set up your dynamic pricing strategy</li>
                    <li>Integrate automated pricing tools</li>
                    <li>Configure guest messaging automation</li>
                    <li>Provide operations SOPs for hands-off management</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- ========================================
         PATH C SLIDES (11 slides)
         ======================================== -->

    <!-- SLIDE 6: PATH C - The STR Ownership Model -->
    <div class="slide slide-process">
        <div class="header">
            <div class="header-badge">C</div>
            <h1>The STR Ownership Model</h1>
        </div>
        <p class="subtitle">How to generate $78K+ year one value through property ownership.</p>

        <div class="steps-flow">
            <div class="step-card">
                <div class="num">01</div>
                <h3>Define Buy-Box</h3>
                <p>Target market, price range, cash flow goals</p>
            </div>
            <div class="step-card">
                <div class="num">02</div>
                <h3>Find The Deal</h3>
                <p>5-10 properties sourced & underwritten</p>
            </div>
            <div class="step-card">
                <div class="num">03</div>
                <h3>Close & Structure</h3>
                <p>Tax setup, entity, cost segregation</p>
            </div>
            <div class="step-card">
                <div class="num">04</div>
                <h3>Launch & Earn</h3>
                <p>Airbnb, VRBO, pricing, ready to book</p>
            </div>
        </div>

        <div class="why-section-horizontal">
            <div class="eyebrow">Why This Works</div>
            <div class="why-cards-row">
                <div class="why-card-horizontal">
                    <div class="why-num">1</div>
                    <div class="why-text">Cost Segregation <span>30% accelerated depreciation year one</span></div>
                </div>
                <div class="why-card-horizontal">
                    <div class="why-num">2</div>
                    <div class="why-text">STR Loophole <span>Offsets W-2 income directly</span></div>
                </div>
                <div class="why-card-horizontal">
                    <div class="why-num">3</div>
                    <div class="why-text">Triple Stack <span>Cash + tax savings + equity</span></div>
                </div>
            </div>
        </div>
    </div>

    <!-- SLIDE 7: PATH C - Year One Math -->
    <div class="slide slide-math-v2">
        <div class="math-v2-header">
            <div class="math-v2-badge">C</div>
            <h1>The Numbers That Matter</h1>
        </div>
        <p class="math-v2-subtitle">How a $500K STR property puts <span class="highlight">$78K+</span> back in your pocket in year one.</p>

        <div class="math-v2-cards">
            <div class="math-v2-card">
                <h3>Cash Flow (Year One)</h3>
                <div class="math-v2-row">
                    <span class="label">Gross Revenue</span>
                    <span class="value positive">$75,000</span>
                </div>
                <div class="math-v2-row">
                    <span class="label">Operating Expenses</span>
                    <span class="value negative">-$52,000</span>
                </div>
                <div class="math-v2-divider"></div>
                <div class="math-v2-row total">
                    <span class="label">Net Cash Flow</span>
                    <span class="value positive">$23,000</span>
                </div>
            </div>

            <div class="math-v2-card">
                <h3>Tax Savings (Year 1 Only)</h3>
                <div class="math-v2-row">
                    <span class="label">Property Cost</span>
                    <span class="value">$500,000</span>
                </div>
                <div class="math-v2-row">
                    <span class="label">Cost Segregation (30%)</span>
                    <span class="value">$150,000</span>
                </div>
                <div class="math-v2-row">
                    <span class="label">x Your Tax Bracket</span>
                    <span class="value">37%</span>
                </div>
                <div class="math-v2-divider gold"></div>
                <div class="math-v2-row total">
                    <span class="label">Tax Refund</span>
                    <span class="value gold">$55,500</span>
                </div>
            </div>
        </div>

        <div class="math-v2-total">
            <span class="total-label">TOTAL YEAR ONE VALUE</span>
            <div class="total-amount"><span class="currency">$</span>78,500</div>
            <p class="total-breakdown">$23K cash + $55.5K tax savings — <em>Plus equity building & appreciation</em></p>
        </div>
    </div>

    <!-- SLIDE 8: PATH C - This Is Built For You If -->
    <div class="slide slide-built-for">
        <div class="header">
            <span class="qualification-badge">Ideal Client Profile</span>
            <h1>This Is Built For You If...</h1>
        </div>

        <div class="featured-row">
            <div class="featured-card">
                <div class="check-icon">✓</div>
                <p>You earn <span class="highlight">$150K+ per year</span> (W-2 or business owner)</p>
            </div>
            <div class="featured-card">
                <div class="check-icon">✓</div>
                <p>You have <span class="highlight">$120K+</span> to deploy (program + down payment + furniture)</p>
            </div>
        </div>

        <div class="standard-grid">
            <div class="standard-card">
                <div class="check-icon">✓</div>
                <p>You're <span class="highlight">ready to buy</span> within the next 4 months</p>
            </div>
            <div class="standard-card">
                <div class="check-icon">✓</div>
                <p>You value <span class="highlight">your time</span> more than learning everything yourself</p>
            </div>
            <div class="standard-card">
                <div class="check-icon">✓</div>
                <p>You're <span class="highlight">tired of watching 30-40%</span> disappear to taxes</p>
            </div>
            <div class="standard-card">
                <div class="check-icon">✓</div>
                <p>You want <span class="highlight">expert guidance</span> on every decision</p>
            </div>
            <div class="standard-card">
                <div class="check-icon">✓</div>
                <p>You want <span class="highlight">real wealth</span> — not just a comfortable retirement</p>
            </div>
            <div class="standard-card">
                <div class="check-icon">✓</div>
                <p>You're <span class="highlight">done waiting</span> — ready to take action now</p>
            </div>
        </div>
    </div>

    <!-- SLIDE 9: PATH C - Why Property Ownership Wins -->
    <div class="slide slide-path-combined">
        <div class="combined-left">
            <div class="path-badge">
                <div class="circle">C</div>
                <div class="label">Path C</div>
            </div>
            <h1>Maximum Tax + Equity + Cash Flow</h1>
            <p class="subtitle">Unlike regular rentals, STR losses can offset your W-2 income directly.</p>

            <div class="combined-benefit-card">
                <div class="combined-benefit-icon">$</div>
                <div class="combined-benefit-content">
                    <h3>Cash Flow</h3>
                    <p>Monthly income from bookings</p>
                </div>
            </div>
            <div class="combined-benefit-card">
                <div class="combined-benefit-icon">%</div>
                <div class="combined-benefit-content">
                    <h3>Tax Savings</h3>
                    <p>$50K+ year one through cost segregation</p>
                </div>
            </div>
            <div class="combined-benefit-card">
                <div class="combined-benefit-icon">↑</div>
                <div class="combined-benefit-content">
                    <h3>Equity</h3>
                    <p>Property appreciation + loan paydown</p>
                </div>
            </div>
        </div>

        <div class="combined-right">
            <div class="combined-comparison-header">
                <h2>Why Property <span class="green">Ownership</span> Wins</h2>
            </div>
            <div class="combined-comparison-items">
                <div class="combined-comparison-item">
                    <div class="amount">$18K</div>
                    <h4>Long-Term Rental</h4>
                    <span class="period">/year income</span>
                    <span class="tag negative">No tax savings</span>
                </div>
                <div class="combined-comparison-item">
                    <div class="amount">$30K</div>
                    <h4>Path B — Arbitrage</h4>
                    <span class="period">/year income</span>
                    <span class="tag negative">No equity</span>
                </div>
                <div class="combined-comparison-item featured">
                    <div class="amount">$78.5K+</div>
                    <h4>Path C — Ownership</h4>
                    <span class="period">/year one value</span>
                    <div class="tags-row">
                        <span class="tag positive">Cash flow</span>
                        <span class="tag positive">Tax savings</span>
                        <span class="tag positive">Equity</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SLIDE 10: PATH C - STR Concierge -->
    <div class="slide slide-dfy-c">
        <div class="dfy-eyebrow">Introducing</div>
        <h1>STR Concierge</h1>
        <p class="dfy-tagline">A Complete Done-For-You Service.<br>We Find The Deals. We Set Up Everything. You Own The Property.</p>
        <div class="dfy-box">
            <p>The only done-for-you service where we <span class="highlight">find and underwrite 5-10 deals FOR you</span> and <span class="highlight">set up everything</span> so you're earning within 4 months.</p>
        </div>
        <div class="scarcity-note">
            <span class="scarcity-number">20</span>
            <div class="scarcity-text">
                <p class="scarcity-headline">Spots available</p>
                <p class="scarcity-reason">We do all the work for you, so capacity is limited.</p>
            </div>
        </div>
    </div>

    <!-- SLIDE 11: PATH C - What We Do For You -->
    <div class="slide slide-buying-lane">
        <div class="header">
            <div class="path-badge">Path C</div>
            <h1>Here's What We Do For You</h1>
        </div>

        <div class="service-cards-2col">
            <div class="service-card">
                <div class="card-num">01</div>
                <h3 class="card-title">We Find & Structure Your Deal</h3>
                <p class="card-subtitle">Done-for-you acquisition — you pick, we handle the rest</p>
                <ul class="card-bullets">
                    <li>Discovery call — define your buy-box and goals</li>
                    <li>5-10 properties sourced & underwritten for you</li>
                    <li>Full market analysis on each deal</li>
                    <li>Offer negotiation support through close</li>
                    <li>Due diligence coordination with inspectors</li>
                    <li>Tax + entity structure setup with CPAs</li>
                    <li>Cost segregation coordination for max savings</li>
                </ul>
                <span class="timeline-tag">Timeline: 90-120 days to close</span>
            </div>

            <div class="service-card">
                <div class="card-num">02</div>
                <h3 class="card-title">We Launch Your STR Operations</h3>
                <p class="card-subtitle">Done-for-you setup — live and earning fast</p>
                <ul class="card-bullets">
                    <li>Airbnb, VRBO, Booking.com listing creation</li>
                    <li>Direct booking website setup</li>
                    <li>Tech stack integration (PriceLabs, Guesty)</li>
                    <li>Automated guest messaging systems</li>
                    <li>Full operational playbook & SOPs</li>
                    <li>30-day + 90-day performance reviews</li>
                </ul>
                <span class="timeline-tag">Timeline: Live 2-3 weeks after close</span>
            </div>
        </div>
    </div>

    <!-- SLIDE 12: PATH C - Tax-Optimized From Day One -->
    <div class="slide slide-tax-optimized">
        <div class="header">
            <h1>Tax-Optimized From Day One</h1>
            <p class="subtitle">Every property is structured for <span class="highlight">maximum tax savings</span>. No missed deductions.</p>
        </div>
        <div class="tax-columns">
            <div class="tax-column">
                <div class="tax-column-header">
                    <div class="header-line gold"></div>
                    <h3 class="gold">Your Strategy</h3>
                </div>
                <div class="tax-column-cards">
                    <div class="tax-card-white gold-accent">
                        <div class="card-header">
                            <div class="tax-icon-box gold">⚖</div>
                            <h4>Entity Structure Guidance</h4>
                        </div>
                        <p>LLC setup optimized for your situation</p>
                    </div>
                    <div class="tax-card-white gold-accent">
                        <div class="card-header">
                            <div class="tax-icon-box gold">📈</div>
                            <h4>Cost Segregation Strategy</h4>
                        </div>
                        <p>Accelerate depreciation in year one</p>
                    </div>
                    <div class="tax-card-white gold-accent">
                        <div class="card-header">
                            <div class="tax-icon-box gold">%</div>
                            <h4>Bonus Depreciation Planning</h4>
                        </div>
                        <p>100% bonus through 2026, then phases down</p>
                    </div>
                </div>
            </div>
            <div class="tax-column">
                <div class="tax-column-header">
                    <div class="header-line green"></div>
                    <h3 class="green">Our Partners</h3>
                </div>
                <div class="tax-column-cards">
                    <div class="tax-card-white green-accent">
                        <div class="card-header">
                            <div class="tax-icon-box green">$</div>
                            <h4>Financing Strategy</h4>
                        </div>
                        <p>DSCR vs conventional — what's right for you</p>
                    </div>
                    <div class="tax-card-white green-accent">
                        <div class="card-header">
                            <div class="tax-icon-box green">🏦</div>
                            <h4>Vetted Lender Referrals</h4>
                        </div>
                        <p>DSCR lenders who understand STRs</p>
                    </div>
                    <div class="tax-card-white green-accent">
                        <div class="card-header">
                            <div class="tax-icon-box green">✓</div>
                            <h4>Cost Seg Company Referral</h4>
                        </div>
                        <p>Partners who know STR depreciation</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SLIDE 13: PATH C - We Set Up Everything -->
    <div class="slide slide-setup">
        <div class="header">
            <span class="setup-badge">We Do It All</span>
            <h1><em>We Log In And Set Up Everything</em></h1>
            <p class="subtitle">This is TRUE done-for-you. Not YouTube tutorials. Not checklists. We do the actual work.</p>
        </div>
        <div class="setup-grid">
            <div class="setup-card-white">
                <div class="card-number">01</div>
                <div class="card-category">Listing Setup</div>
                <ul>
                    <li>Airbnb listing creation + optimization</li>
                    <li>VRBO listing creation</li>
                    <li>Booking.com setup</li>
                    <li>Direct booking website</li>
                </ul>
            </div>
            <div class="setup-card-white">
                <div class="card-number">02</div>
                <div class="card-category">Operational Playbook</div>
                <ul>
                    <li>Cleaner hiring guidance</li>
                    <li>Cleaning checklist template</li>
                    <li>Guest communication SOPs</li>
                    <li>Emergency response playbook</li>
                </ul>
            </div>
            <div class="setup-card-white">
                <div class="card-number">03</div>
                <div class="card-category">Tech Stack</div>
                <ul>
                    <li>Price Labs account + strategy</li>
                    <li>Guesty or PMS setup</li>
                    <li>Automated messaging</li>
                    <li>Calendar sync across platforms</li>
                </ul>
            </div>
            <div class="setup-card-white">
                <div class="card-number">04</div>
                <div class="card-category">Post-Launch Support</div>
                <ul>
                    <li>30-day check-in call</li>
                    <li>90-day performance review</li>
                    <li>Direct messaging access</li>
                    <li>Troubleshooting as you go live</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- SLIDE 14: PATH C - Vetted Referral Network -->
    <div class="slide slide-referrals">
        <div class="header">
            <span class="network-badge">Trusted Partners</span>
            <h1>Plus: Our Vetted Referral Network</h1>
            <p class="subtitle">Skip the guesswork. We connect you with partners who <span class="highlight">specialize in STRs</span>.</p>
        </div>
        <div class="referral-grid">
            <div class="referral-card-white">
                <div class="referral-icon-box gold">$</div>
                <h3>DSCR Lenders</h3>
                <p>Financing experts who understand STR income</p>
            </div>
            <div class="referral-card-white">
                <div class="referral-icon-box green">%</div>
                <h3>Cost Seg Companies</h3>
                <p>Maximize year-one depreciation</p>
            </div>
            <div class="referral-card-white">
                <div class="referral-icon-box gold">✓</div>
                <h3>CPAs</h3>
                <p>Tax pros who know real estate</p>
            </div>
            <div class="referral-card-white">
                <div class="referral-icon-box green">⌂</div>
                <h3>Real Estate Agents</h3>
                <p>Market-specific investor specialists</p>
            </div>
            <div class="referral-card-white">
                <div class="referral-icon-box gold">◈</div>
                <h3>Interior Designers</h3>
                <p>STR staging and furnishing pros</p>
            </div>
            <div class="referral-card-white">
                <div class="referral-icon-box green">⚙</div>
                <h3>Property Managers</h3>
                <p>For hands-off investing option</p>
            </div>
        </div>
    </div>

    <!-- SLIDE 15: Decision Flowchart -->
    <div class="slide slide-decision">
        <div class="decision-header">
            <span class="decision-eyebrow">Decision Guide</span>
            <h1>Which Path Is Right For You?</h1>
            <p class="decision-subtitle">Follow the decision tree to find your perfect fit based on your goals, capital, and situation</p>
        </div>

        <div class="flowchart-centered">
            <div class="flowchart-box-full">
                <div class="flow-node flow-start">
                    <div class="flow-node-title">START</div>
                    <div class="flow-node-subtitle">What's your situation?</div>
                </div>

                <div class="flow-arrow">↓</div>

                <div class="flow-node flow-question">
                    <span>Do you have $120K+ to deploy?</span>
                </div>

                <div class="flow-branch-main">
                    <div class="flow-branch-left">
                        <span class="branch-label yes">YES</span>
                        <div class="flow-arrow-small">↓</div>
                        <div class="flow-node flow-path path-c">
                            <div class="path-label">PATH C</div>
                            <div class="path-desc">Max Tax + Equity</div>
                        </div>
                    </div>
                    <div class="flow-branch-right">
                        <span class="branch-label no">NO</span>
                        <div class="flow-arrow-small">↓</div>
                        <div class="flow-node flow-question small">
                            <span>Want more cash flow?</span>
                        </div>
                        <div class="flow-branch-inner">
                            <div class="flow-branch-left">
                                <span class="branch-label yes">YES</span>
                                <div class="flow-arrow-small">↓</div>
                                <div class="flow-node flow-path path-b">
                                    <div class="path-label">PATH B</div>
                                    <div class="path-desc">Cash Flow</div>
                                </div>
                            </div>
                            <div class="flow-branch-right">
                                <span class="branch-label no">NO</span>
                                <div class="flow-arrow-small">↓</div>
                                <div class="flow-node flow-path path-a">
                                    <div class="path-label">PATH A</div>
                                    <div class="path-desc">Optimize</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SLIDE 16: Side-by-Side Comparison -->
    <div class="slide slide-comparison-table">
        <div class="comparison-table-header">
            <span class="comparison-eyebrow">Choose Your Path</span>
            <h1>Compare All Three Paths</h1>
        </div>

        <div class="comparison-table-centered">
            <div class="comparison-columns-wrapper">
                <div class="factor-labels-col">
                    <div class="factor-label-item">Capital Needed</div>
                    <div class="factor-label-item">Monthly Cash Flow</div>
                    <div class="factor-label-item">Year 1 Tax Savings</div>
                    <div class="factor-label-item">Equity Building</div>
                    <div class="factor-label-item">Time Commitment</div>
                    <div class="factor-label-item">Best For</div>
                    <div class="factor-label-item">Service Level</div>
                </div>

                <div class="path-column">
                    <div class="path-column-header">
                        <div class="path-letter">A</div>
                        <div class="path-name">Optimize</div>
                    </div>
                    <div class="path-values">
                        <div class="path-value-item">$2.5-5K</div>
                        <div class="path-value-item">—</div>
                        <div class="path-value-item highlight-gold">$15-30K</div>
                        <div class="path-value-item"><span class="check-no">No</span></div>
                        <div class="path-value-item">2-4 hrs/wk</div>
                        <div class="path-value-item best-for">You want to optimize your taxes, debt, and investment portfolio</div>
                        <div class="path-value-item">Complete Roadmap, You Execute</div>
                    </div>
                </div>

                <div class="path-column">
                    <div class="path-column-header">
                        <div class="path-letter">B</div>
                        <div class="path-name">Optimize + Cash Flow</div>
                    </div>
                    <div class="path-values">
                        <div class="path-value-item">$10-25K</div>
                        <div class="path-value-item highlight-green">$2K/mo per property</div>
                        <div class="path-value-item highlight-gold">$15-30K</div>
                        <div class="path-value-item"><span class="check-no">No</span></div>
                        <div class="path-value-item">10 hrs/wk</div>
                        <div class="path-value-item best-for">You want to optimize everything plus generate monthly cash flow</div>
                        <div class="path-value-item">Guided Sourcing, Done-For-You Setup</div>
                    </div>
                </div>

                <div class="path-column featured">
                    <div class="path-column-header">
                        <span class="spots-badge">20 Spots Total</span>
                        <div class="path-letter">C</div>
                        <div class="path-name">Max Tax Savings + Cash Flow + Equity</div>
                    </div>
                    <div class="path-values">
                        <div class="path-value-item">$120K+</div>
                        <div class="path-value-item highlight-green">$1.5-2.5K</div>
                        <div class="path-value-item highlight-gold">$50K+</div>
                        <div class="path-value-item"><span class="check-yes">✓ Yes</span></div>
                        <div class="path-value-item">5-10 hrs total</div>
                        <div class="path-value-item best-for">You want it all: optimization, cash flow, maximum tax savings, and long-term wealth building</div>
                        <div class="path-value-item">Complete Done-For-You Service</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SLIDE 17: THE ROI -->
    <div class="slide slide-roi">
        <div class="roi-top-bar"></div>

        <div class="roi-content">
            <h1 class="roi-title">THE ROI</h1>

            <div class="roi-chevrons">
                <span class="roi-chevron">❯</span>
                <span class="roi-chevron">❯</span>
                <span class="roi-chevron">❯</span>
            </div>

            <div class="roi-points">
                <div class="roi-point">
                    <span class="roi-icon">✅</span>
                    <span>If you <span class="underline">only</span> did <span class="bold">tax savings</span>, You'd <span class="highlight-yellow">save $15,000+ this year.</span></span>
                </div>
                <div class="roi-point">
                    <span class="roi-icon">🔄</span>
                    <span>And with compounding, o<span class="bold">ver 5 years you'd be ahead by $75,000+,</span> not even counting growth on what you kept.</span>
                </div>
            </div>

            <div class="roi-image-container">
                <img src="images/roi-process.png" alt="5 Tax Strategies: STR Loophole, Cost Segregations, Mega Backdoor Roth, Augusta Rule, Home Office Deduction">
            </div>
        </div>

        <div class="roi-footer">
            <div class="roi-footer-left">
                <span class="goto-text">GO TO</span>
                <span class="goto-url">MANAGEMONEY101.COM</span>
            </div>
            <div class="help-text">Need Help? Send an email to -<br>preston@legacyinvestingshow.com</div>
        </div>
    </div>

    <div id="save-indicator" class="save-indicator">Saved</div>

    <div class="toolbar" id="toolbar">
        <button class="toolbar-toggle" onclick="toggleToolbar()" title="Tools">+</button>
        <div class="toolbar-menu">
            <button onclick="downloadUpdatedHTML(); toggleToolbar(true)">Download HTML</button>
            <button onclick="triggerImportEdits(); toggleToolbar(true)" class="btn-secondary">Import Edits</button>
            <button onclick="exportChanges(); toggleToolbar(true)" class="btn-secondary">Export JSON</button>
        </div>
    </div>
    <input type="file" id="import-file-input" class="hidden-input" accept=".json" onchange="handleImportFile(event)">

    <script>
        // Presentation Mode with Presenter Notes
        (function() {
            const slides = document.querySelectorAll('.slide');
            let currentSlideIndex = 0;
            let presenterWindow = null;
            const channel = new BroadcastChannel('presentation-sync');

            // ========================================
            // PRESENTER NOTES - ALL 17 SLIDES (Teleprompter Script Format)
            // ========================================

            // Default scripts - stored separately for reset functionality
            const defaultSlideNotes = [
                // Slide 1: PATH A - Legacy Wealth Blueprint
                {
                    slideTitle: "Slide 1: PATH A - Legacy Wealth Blueprint",
                    script: `Alright, let's dive into Path A. This is our foundation—the Legacy Wealth Blueprint. Everything starts here.

[CLICK] So we're looking at Path A right now...

[CLICK] Let me show you exactly what you're getting with this program.

[CLICK] First up—over 100 video lessons. These are yours for life. Watch them whenever you want, as many times as you need.

[CLICK] You also get a dedicated 1-on-1 Wealth Guide. This isn't some chatbot. This is a real person in your corner.

[CLICK] Then there's our Wealth Circle Community. That's 12 full months of being surrounded by people on the same journey.

[CLICK] And here's something I'm really excited about—your own Personal AI Wealth Advisor. This thing is powerful.

[CLICK] Weekly live coaching calls, plus all the replays. So you never miss anything, even if life gets busy.

[CLICK] SOPs, templates, checklists—all the stuff that used to take me years to build. You get it day one.

[CLICK] We'll track your progress with a 12-Month Wealth Snapshot. Real numbers. Real accountability.

[CLICK] Oh, and you can bring your spouse or partner along. No extra charge. Because wealth-building is a team sport.

[CLICK] Now let's talk about the actual curriculum—what you're going to learn.

[CLICK] Pillar one is Tax Optimization. This alone can save you anywhere from $50K to $200K a year. Legally.

[CLICK] Pillar two—Debt & Credit Leverage. I'm going to show you how to access 0% financing and make your credit work for you.

[CLICK] Pillar three is Income Acceleration. We're talking $5K to $20K per month in passive income streams.

[CLICK] Pillar four covers Investment Vehicles. Think Roth conversions, self-directed IRAs—money growing tax-free.

[CLICK] And pillar five is Wealth Protection. Asset protection strategies so nobody can take what you've built.`
                },

                // Slide 2: PATH B - Airbnb Arbitrage Model
                {
                    slideTitle: "Slide 2: PATH B - The Airbnb Arbitrage Model",
                    script: `Now Path B is where things get really interesting. This is for people who want cash flow—real money coming in—without having to buy property.

[CLICK] We're moving into Path B territory now...

[CLICK] This is what we call the Airbnb Arbitrage Model.

[CLICK] The headline here? You can generate $3K to $10K per month without ever owning the property. Let that sink in.

[CLICK] Step one—you find a property in a high-demand short-term rental area. We show you exactly how.

[CLICK] Step two—you sign a standard 12-month lease. Just like renting an apartment.

[CLICK] Step three—you furnish it, make it beautiful, and list it on Airbnb, VRBO, Booking.com.

[CLICK] Step four—you start generating cash flow. Typically 2 to 3 times what you're paying in rent.

[CLICK] Now let me tell you why this model actually works...

[CLICK] Low capital entry. You can get started with just $10K to $25K. Compare that to buying a property.

[CLICK] Speed to revenue. We're talking 30 to 60 days from signing a lease to making money.

[CLICK] And here's the kicker—you can structure this to be completely tax-free through a self-directed IRA.

[CLICK] Plus it's 100% remote. You can run this from anywhere in the world. And it scales.

[CLICK] Look at these real numbers. $2,500 a month in rent. $6,500 in revenue. That's $2,500 profit. Every single month.`
                },

                // Slide 3: PATH B - Everything in Path A Plus
                {
                    slideTitle: "Slide 3: PATH B - Done-For-You Services",
                    script: `Here's what makes Path B different. We're not just teaching you—we're actually doing it with you.

[CLICK] Still in Path B here...

[CLICK] You get everything from Path A, plus all of this.

[CLICK] These are our done-for-you services. Let me walk you through them.

[CLICK] We handle property setup and listing design. Professional photos, compelling descriptions, the works.

[CLICK] Furnishing and interior optimization. We know exactly what makes guests book.

[CLICK] Operations and guest management. All the day-to-day stuff that would normally eat up your time.

[CLICK] And messaging automation. Your guests get taken care of 24/7 without you lifting a finger.`
                },

                // Slide 4: PATH B - Your Success Toolkit
                {
                    slideTitle: "Slide 4: PATH B - Success Toolkit",
                    script: `Let me show you the actual tools you're getting access to. This is your complete success toolkit.

[CLICK] Path B gives you everything you need to succeed...

[CLICK] Your Success Toolkit. Every tool you need in one place.

[CLICK] First—a dedicated 1-on-1 STR coach. Someone who's actually done this.

[CLICK] This is what that looks like. Real coaching, real support.

[CLICK] The complete Airbnb Ascension Curriculum. Step by step, nothing left out.

[CLICK] Here's the training platform. Clean, organized, easy to follow.

[CLICK] Property Profitability Analysis. We'll crunch the numbers on any deal before you commit.

[CLICK] This is an actual report we generate. You'll know exactly what to expect.

[CLICK] Full access to AirDNA. This is a $14,400 per year value—included.

[CLICK] Look at this dashboard. Market data, occupancy rates, revenue projections. All of it.

[CLICK] Uplisting for channel management. One place to manage all your listings.

[CLICK] Here's the interface. Airbnb, VRBO, Booking.com—all synced.

[CLICK] Our Market Matrix covers over 500 markets across the country.

[CLICK] Every market analyzed. Every opportunity identified.

[CLICK] Your own AI Advisor for instant answers to any question.

[CLICK] Like having an expert available 24/7.

[CLICK] Complete library of scripts and templates. Landlord outreach, lease agreements, everything.

[CLICK] All the documents you need, ready to use.`
                },

                // Slide 5: PATH B - What We Do For You
                {
                    slideTitle: "Slide 5: PATH B - Service Breakdown",
                    script: `Let me break down exactly what we do versus what you do. There are three pillars here.

[CLICK] This is the Path B service breakdown...

[CLICK] What We Do For You. Your job is finding properties. Our job is everything else.

[CLICK] Pillar one—we help you acquire the lease. Training, scripts, even roleplay calls to practice. Plus landlord references.

[CLICK] Pillar two—we set up your entire operation. Design guidance, listing creation, optimization for bookings.

[CLICK] Pillar three—we automate your systems. Dynamic pricing, guest messaging, SOPs. It runs itself.`
                },

                // Slide 6: PATH C - STR Ownership Model
                {
                    slideTitle: "Slide 6: PATH C - STR Ownership Model",
                    script: `Alright, now we're getting to Path C. This is the big one. Full ownership. Maximum wealth-building.

[CLICK] Welcome to Path C...

[CLICK] The STR Ownership Model. This is where real wealth gets built.

[CLICK] Year one value? We're talking $78,000 or more. That's not revenue—that's what you keep.

[CLICK] Step one—we define your buy-box. What makes sense for your situation, your goals, your risk tolerance.

[CLICK] Step two—we go find the deal. We source 5 to 10 properties that fit your criteria.

[CLICK] Step three—closing and structuring. Entity setup, financing, tax optimization. We handle the details.

[CLICK] Step four—launch and earn. You go live and start generating income.

[CLICK] Now here's why ownership is such a game-changer...

[CLICK] Cost segregation lets you accelerate depreciation. Massive tax write-offs in year one.

[CLICK] The STR loophole means those losses can offset your W-2 income. This is huge for high earners.

[CLICK] And then you're triple-stacking. Cash flow plus tax savings plus equity appreciation. All at once.`
                },

                // Slide 7: PATH C - Year One Math
                {
                    slideTitle: "Slide 7: PATH C - The Numbers",
                    script: `Let me show you the actual math. Real numbers on a real property.

[CLICK] Path C—let's look at the numbers...

[CLICK] We're using a $500K property as our example. Pretty standard for a solid STR.

[CLICK] Cash flow: $75K in gross revenue, minus $52K in expenses. That's $23,000 net in your pocket.

[CLICK] Tax savings: Take that $500K, apply 30% cost seg, at a 37% tax rate. That's a $55,500 refund check.

[CLICK] Add it up. $78,500 in year one value. From one property. This is why ownership wins.`
                },

                // Slide 8: PATH C - Built For You If
                {
                    slideTitle: "Slide 8: PATH C - Ideal Client",
                    script: `Now, Path C isn't for everyone. Let me be really clear about who this is designed for.

[CLICK] Built For You If... let's see if this fits.

[CLICK] You're earning $150K or more. W-2 income or business owner. You need that tax liability to offset.

[CLICK] You have $120K or more ready to deploy. Down payment plus setup costs.

[CLICK] You're ready to buy within the next 4 months. Not someday—now.

[CLICK] And you value your time more than DIY learning. You want it done right, done fast.`
                },

                // Slide 9: PATH C - Why Ownership Wins
                {
                    slideTitle: "Slide 9: PATH C - Why Ownership Wins",
                    script: `Let's put this in perspective. Compare ownership to the alternatives.

[CLICK] Path C—why ownership wins every time...

[CLICK] Ownership outperforms in every single metric. Let me prove it.

[CLICK] Traditional long-term rental? Maybe $18K a year. And zero tax savings. Boring.

[CLICK] Path B arbitrage? Around $30K a year in cash flow. Great, but no equity building.

[CLICK] Path C ownership? $78,500 plus. Cash flow, tax savings, and you're building equity. The trifecta.

[CLICK] That's exactly why we built STR Concierge...

[CLICK] We find 5 to 10 deals for you. All underwritten. All vetted.

[CLICK] You're earning within 4 months. Guaranteed.

[CLICK] But here's the thing—we only take 20 clients at a time. That's it.`
                },

                // Slide 10: PATH C - STR Concierge
                {
                    slideTitle: "Slide 10: STR Concierge",
                    script: `This is it. STR Concierge. Our complete done-for-you ownership program.

[CLICK] STR Concierge...

[CLICK] We Find Your Deal. We Set It Up. You Earn.

[CLICK] Complete done-for-you short-term rental ownership.

[CLICK] Deal sourcing—we bring you 5 to 10 properties, all professionally underwritten.

[CLICK] Full setup—from closing to your first booking in 4 months or less.

[CLICK] Only 20 spots available. When they're gone, they're gone.`
                },

                // Slide 11: PATH C - What We Do For You
                {
                    slideTitle: "Slide 11: PATH C - Service Breakdown",
                    script: `Two phases. That's all it takes to go from zero to earning.

[CLICK] Here's exactly how we get you to earning...

[CLICK] Phase one: Find & Structure. This takes 90 to 120 days.

[CLICK] We start with a discovery call. Really understand your goals, your situation.

[CLICK] Then we source 5 to 10 properties. Every single one professionally underwritten.

[CLICK] We negotiate and close for you. All the details handled.

[CLICK] Entity and tax setup. Optimal structure for maximum benefits.

[CLICK] Phase two: Launch Operations. This is just 2 to 3 weeks.

[CLICK] All your listings created. Airbnb, VRBO, direct booking site.

[CLICK] Tech stack configured. Pricing software, messaging automation, everything.

[CLICK] Full operational playbook. SOPs, cleaner relationships, emergency protocols.`
                },

                // Slide 12: PATH C - Tax-Optimized
                {
                    slideTitle: "Slide 12: Tax-Optimized Structure",
                    script: `Every single property we set up is structured for maximum tax savings. This isn't an afterthought.

[CLICK] Your tax strategy—this is where the magic happens...

[CLICK] Entity structure planning. The right LLC setup for your situation.

[CLICK] Cost segregation study. Accelerate that depreciation to year one.

[CLICK] Bonus depreciation capture. Take it all upfront while you can.

[CLICK] STR loophole qualification. Make sure you meet the requirements.

[CLICK] And we've got partners for everything...

[CLICK] DSCR lenders. Investment property financing with no income verification needed.

[CLICK] Cost seg companies. The best in the business for maximizing depreciation.

[CLICK] Real estate CPAs. Ongoing optimization year after year.`
                },

                // Slide 13: PATH C - We Set Up Everything
                {
                    slideTitle: "Slide 13: TRUE Done-For-You",
                    script: `This isn't watching YouTube tutorials and figuring it out yourself. We do the actual work.

[CLICK] TRUE Done-For-You Setup...

[CLICK] Listing setup across every platform. Airbnb, VRBO, Booking.com, your own direct booking site.

[CLICK] Complete operational playbook. Cleaner schedules, SOPs, emergency protocols.

[CLICK] Your entire tech stack. PriceLabs, Guesty, all the automation.

[CLICK] And we don't disappear after launch. 30-day and 90-day check-ins to make sure everything's optimized.`
                },

                // Slide 14: PATH C - Referral Network
                {
                    slideTitle: "Slide 14: Partner Network",
                    script: `You know what takes most people years? Building relationships with the right partners. We've already done it.

[CLICK] Our vetted partner network...

[CLICK] DSCR Lenders who specialize in investment property financing.

[CLICK] Cost Seg Companies—the best depreciation specialists in the country.

[CLICK] Real Estate CPAs who understand STR tax optimization inside and out.

[CLICK] STR Agents with deep market-specific expertise.

[CLICK] Interior Designers who know exactly what drives bookings.

[CLICK] Property Managers for completely hands-off operations if you want it.`
                },

                // Slide 15: Decision Flowchart
                {
                    slideTitle: "Slide 15: Which Path Is Right?",
                    script: `Okay, let's figure out which path makes the most sense for you. This is simple.

[CLICK] Decision time...

[CLICK] Which Path Is Right For You?

[CLICK] It really comes down to a few key questions.

[CLICK] First question: Do you have $120K or more to deploy right now?

[CLICK] If yes—Path C. Full ownership. Maximum wealth-building.

[CLICK] If not, next question: Do you want cash flow coming in?

[CLICK] If yes—Path B. Arbitrage model. Start generating income fast.

[CLICK] If you just want the education foundation—Path A. Build your knowledge first.`
                },

                // Slide 16: Compare All Three Paths
                {
                    slideTitle: "Slide 16: Side-by-Side Comparison",
                    script: `Here's everything side by side. Take a look and tell me which one feels right for your situation.

[CLICK] Let's compare all three paths...

[CLICK] Compare All Three Paths. Everything at a glance.

[CLICK] Here are the key factors to consider...

[CLICK] Path A: $2,500 to $5K investment. Focus on tax savings. You execute what you learn.

[CLICK] Path B: $10K to $25K investment. Cash flow plus tax optimization. We guide you through it.

[CLICK] Path C: $120K or more investment. You get everything. Complete done-for-you.`
                },

                // Slide 17: THE ROI
                {
                    slideTitle: "Slide 17: THE ROI",
                    script: `Now let's talk about the actual return on investment. This is what it all comes down to.

[CLICK] The ROI. Let me show you the numbers.

[CLICK] If you only focused on tax savings—just that one piece—you'd save at least $15,000 this year.

[CLICK] But here's where it gets interesting. With compounding, over 5 years you'd be ahead by $75,000 or more. And that's not even counting growth on the money you kept.

[CLICK] These are our five core tax strategies: STR Loophole, Cost Segregations plus Bonus Depreciation, the Mega Backdoor Roth, the Augusta Rule, and the Home Office Deduction.

[CLICK] Each one of these strategies can save you thousands. Together? They're a game-changer.`
                }
            ];

            // Working copy of slideNotes (can be modified by user)
            let slideNotes = JSON.parse(JSON.stringify(defaultSlideNotes));

            // Parse script into segments
            function parseScript(script) {
                if (!script) return [];
                const parts = script.split(/\[CLICK\]/i);
                return parts.map((text, index) => ({
                    index: index,
                    text: text.trim(),
                    isIntro: index === 0
                })).filter(segment => segment.text.length > 0);
            }

            // Simple vertical scroll mode - no animations

            // Presenter View
            function openPresenterView() {
                const presenterHTML = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Presenter View - Legacy Investing</title>
                    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
                    <style>
                        * { margin: 0; padding: 0; box-sizing: border-box; }
                        body {
                            font-family: 'Inter', sans-serif;
                            background: #1a1a1a;
                            color: #fff;
                            min-height: 100vh;
                            padding: 20px;
                        }
                        .presenter-container {
                            display: grid;
                            grid-template-columns: 2fr 1fr;
                            grid-template-rows: auto 1fr auto;
                            gap: 20px;
                            height: calc(100vh - 40px);
                        }
                        .header {
                            grid-column: 1 / -1;
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            padding: 15px 20px;
                            background: #2a2a2a;
                            border-radius: 10px;
                        }
                        .slide-info {
                            font-size: 24px;
                            font-weight: 700;
                            color: #d4af37;
                        }
                        .timer {
                            font-size: 32px;
                            font-weight: 700;
                            font-family: monospace;
                        }
                        .controls {
                            display: flex;
                            gap: 10px;
                        }
                        .controls button {
                            background: #d4af37;
                            color: #1a1a1a;
                            border: none;
                            padding: 8px 16px;
                            border-radius: 6px;
                            font-weight: 600;
                            cursor: pointer;
                            font-size: 13px;
                        }
                        .controls button:hover {
                            background: #e8c959;
                        }
                        .controls button.btn-danger {
                            background: #ef4444;
                            color: white;
                        }
                        .controls button.btn-danger:hover {
                            background: #dc2626;
                        }
                        .modified-indicator {
                            background: #f59e0b;
                            color: #1a1a1a;
                            padding: 4px 10px;
                            border-radius: 4px;
                            font-size: 11px;
                            font-weight: 600;
                            margin-left: 10px;
                        }

                        /* Teleprompter Section */
                        .teleprompter-section {
                            background: #2a2a2a;
                            border-radius: 10px;
                            padding: 0;
                            position: relative;
                            overflow: hidden;
                        }
                        .teleprompter-header {
                            position: sticky;
                            top: 0;
                            background: #2a2a2a;
                            padding: 20px 25px 15px;
                            border-bottom: 2px solid #d4af37;
                            z-index: 10;
                        }
                        .slide-title-presenter {
                            font-size: 18px;
                            font-weight: 700;
                            color: #d4af37;
                            margin-bottom: 10px;
                        }
                        .anim-progress {
                            font-size: 12px;
                            color: #888;
                            display: flex;
                            align-items: center;
                            gap: 10px;
                        }
                        .anim-progress .progress-bar {
                            flex: 1;
                            height: 4px;
                            background: #333;
                            border-radius: 2px;
                            overflow: hidden;
                        }
                        .anim-progress .progress-fill {
                            height: 100%;
                            background: linear-gradient(90deg, #d4af37, #e8c959);
                            transition: width 0.3s ease;
                        }

                        /* Teleprompter scroll container */
                        .teleprompter-scroll {
                            height: calc(100% - 80px);
                            overflow-y: auto;
                            padding: 20px 25px 100px;
                            scroll-behavior: smooth;
                        }
                        .teleprompter-scroll::before,
                        .teleprompter-scroll::after {
                            content: '';
                            position: absolute;
                            left: 0;
                            right: 0;
                            height: 40px;
                            pointer-events: none;
                            z-index: 5;
                        }
                        .teleprompter-scroll::before {
                            top: 80px;
                            background: linear-gradient(to bottom, #2a2a2a, transparent);
                        }
                        .teleprompter-scroll::after {
                            bottom: 0;
                            background: linear-gradient(to top, #2a2a2a, transparent);
                        }

                        /* Script segments */
                        .script-segment {
                            padding: 15px 18px;
                            margin-bottom: 12px;
                            border-radius: 8px;
                            background: rgba(255,255,255,0.03);
                            transition: all 0.3s ease;
                            cursor: pointer;
                            border: 2px solid transparent;
                            font-size: 16px;
                            line-height: 1.7;
                        }
                        .script-segment:hover {
                            background: rgba(255,255,255,0.06);
                            border-color: rgba(212, 175, 55, 0.3);
                        }
                        .script-segment.past {
                            opacity: 0.35;
                            font-size: 14px;
                            padding: 10px 15px;
                            text-decoration: line-through;
                            text-decoration-color: rgba(255,255,255,0.3);
                        }
                        .script-segment.current {
                            background: rgba(74, 222, 128, 0.12);
                            border-color: #4ade80;
                            font-size: 20px;
                            font-weight: 500;
                            color: #4ade80;
                            box-shadow: 0 0 20px rgba(74, 222, 128, 0.2);
                        }
                        .script-segment.upcoming {
                            opacity: 0.6;
                            font-size: 15px;
                        }
                        .script-segment.far-upcoming {
                            opacity: 0.35;
                            font-size: 14px;
                        }

                        /* Click markers between segments */
                        .click-divider {
                            display: flex;
                            align-items: center;
                            margin: 8px 0;
                            padding: 0 10px;
                        }
                        .click-divider::before,
                        .click-divider::after {
                            content: '';
                            flex: 1;
                            height: 1px;
                            background: rgba(255,255,255,0.1);
                        }
                        .click-divider span {
                            padding: 4px 12px;
                            font-size: 10px;
                            font-weight: 700;
                            letter-spacing: 2px;
                            color: #666;
                            text-transform: uppercase;
                        }
                        .click-divider.next-click span {
                            color: #ef4444;
                            background: rgba(239, 68, 68, 0.15);
                            border-radius: 4px;
                            animation: pulse 1.5s ease-in-out infinite;
                        }
                        @keyframes pulse {
                            0%, 100% { opacity: 1; }
                            50% { opacity: 0.5; }
                        }

                        /* Edit mode for segments */
                        .script-segment.editing {
                            padding: 0;
                            background: transparent;
                            border-color: #d4af37;
                        }
                        .script-segment.editing textarea {
                            width: 100%;
                            min-height: 120px;
                            padding: 15px 18px;
                            background: rgba(212, 175, 55, 0.1);
                            border: none;
                            border-radius: 6px;
                            color: #fff;
                            font-family: 'Inter', sans-serif;
                            font-size: 16px;
                            line-height: 1.7;
                            resize: vertical;
                        }
                        .script-segment.editing textarea:focus {
                            outline: none;
                        }
                        .edit-hint {
                            font-size: 10px;
                            color: #666;
                            text-align: right;
                            padding: 5px 10px 0;
                        }

                        /* Next slide section */
                        .next-section {
                            background: #2a2a2a;
                            border-radius: 10px;
                            padding: 25px;
                            display: flex;
                            flex-direction: column;
                        }
                        .next-section h2 {
                            color: #888;
                            font-size: 12px;
                            text-transform: uppercase;
                            letter-spacing: 2px;
                            margin-bottom: 15px;
                        }
                        .next-preview {
                            font-size: 14px;
                            color: #aaa;
                            line-height: 1.6;
                            flex: 1;
                        }
                        .next-preview .next-title {
                            color: #d4af37;
                            font-weight: 600;
                            margin-bottom: 10px;
                        }
                        .next-preview .next-intro {
                            font-size: 13px;
                            opacity: 0.7;
                        }

                        /* End of slide indicator */
                        .end-slide {
                            color: #888;
                            font-style: italic;
                            margin-top: 30px;
                            padding: 20px;
                            background: rgba(255,255,255,0.03);
                            border-radius: 8px;
                            text-align: center;
                            border: 1px dashed rgba(255,255,255,0.2);
                        }
                        .end-slide .arrow {
                            color: #d4af37;
                            margin-right: 8px;
                        }

                        .footer {
                            grid-column: 1 / -1;
                            display: flex;
                            justify-content: center;
                            gap: 30px;
                            padding: 15px;
                            background: #2a2a2a;
                            border-radius: 10px;
                        }
                        .footer span {
                            color: #888;
                        }
                        .footer kbd {
                            background: #444;
                            padding: 4px 8px;
                            border-radius: 4px;
                            font-family: monospace;
                        }

                        .anim-info {
                            font-size: 14px;
                            color: #888;
                            margin-left: 15px;
                        }
                    </style>
                </head>
                <body>
                    <div class="presenter-container">
                        <div class="header">
                            <div class="slide-info">
                                Slide <span id="current-slide">1</span> of <span id="total-slides">16</span>
                                <span class="anim-info" id="anim-info"></span>
                                <span id="modified-indicator" class="modified-indicator" style="display:none">Modified</span>
                            </div>
                            <div class="timer" id="timer">00:00:00</div>
                            <div class="controls">
                                <button onclick="resetTimer()">Reset Timer</button>
                                <button onclick="resetScripts()" class="btn-danger">Reset to Default</button>
                            </div>
                        </div>
                        <div class="teleprompter-section">
                            <div class="teleprompter-header">
                                <div class="slide-title-presenter" id="slide-title"></div>
                                <div class="anim-progress">
                                    <span id="progress-text">0 of 0</span>
                                    <div class="progress-bar"><div class="progress-fill" id="progress-fill" style="width: 0%"></div></div>
                                    <span id="progress-percent">0%</span>
                                </div>
                            </div>
                            <div class="teleprompter-scroll" id="teleprompter-scroll">
                                <div id="teleprompter-content"></div>
                            </div>
                        </div>
                        <div class="next-section">
                            <h2>Up Next</h2>
                            <div class="next-preview" id="next-preview"></div>
                        </div>
                        <div class="footer">
                            <span>Vertical scroll mode - all slides visible</span>
                            <span>Click segment to edit</span>
                        </div>
                    </div>
                    <script>
                        const channel = new BroadcastChannel('presentation-sync');
                        let startTime = Date.now();
                        let currentEditingSegment = null;
                        let lastSegmentIndex = -1;

                        function updateTimer() {
                            const elapsed = Date.now() - startTime;
                            const hours = Math.floor(elapsed / 3600000);
                            const minutes = Math.floor((elapsed % 3600000) / 60000);
                            const seconds = Math.floor((elapsed % 60000) / 1000);
                            document.getElementById('timer').textContent =
                                String(hours).padStart(2, '0') + ':' +
                                String(minutes).padStart(2, '0') + ':' +
                                String(seconds).padStart(2, '0');
                        }
                        setInterval(updateTimer, 1000);

                        function resetTimer() {
                            startTime = Date.now();
                        }

                        function resetScripts() {
                            if (confirm('Reset all scripts to default? Your edits will be lost.')) {
                                channel.postMessage({ type: 'reset-scripts' });
                            }
                        }

                        function scrollToCurrentSegment() {
                            const current = document.querySelector('.script-segment.current');
                            if (current) {
                                const container = document.getElementById('teleprompter-scroll');
                                const containerHeight = container.clientHeight;
                                const targetPosition = current.offsetTop - (containerHeight * 0.3);
                                container.scrollTo({
                                    top: Math.max(0, targetPosition),
                                    behavior: 'smooth'
                                });
                            }
                        }

                        function startEditing(segmentEl, segmentIndex, slideIndex) {
                            if (currentEditingSegment !== null) return;
                            currentEditingSegment = segmentIndex;

                            const text = segmentEl.dataset.text;
                            segmentEl.classList.add('editing');
                            segmentEl.innerHTML = \`
                                <textarea>\${text}</textarea>
                                <div class="edit-hint">Ctrl+Enter to save, Escape to cancel</div>
                            \`;

                            const textarea = segmentEl.querySelector('textarea');
                            textarea.focus();
                            textarea.selectionStart = textarea.value.length;

                            textarea.addEventListener('keydown', (e) => {
                                if (e.key === 'Escape') {
                                    e.preventDefault();
                                    cancelEditing(segmentEl, text);
                                } else if (e.key === 'Enter' && e.ctrlKey) {
                                    e.preventDefault();
                                    saveEditing(segmentEl, textarea.value, segmentIndex, slideIndex);
                                }
                            });

                            textarea.addEventListener('blur', () => {
                                setTimeout(() => {
                                    if (currentEditingSegment === segmentIndex) {
                                        saveEditing(segmentEl, textarea.value, segmentIndex, slideIndex);
                                    }
                                }, 100);
                            });
                        }

                        function cancelEditing(segmentEl, originalText) {
                            currentEditingSegment = null;
                            segmentEl.classList.remove('editing');
                            segmentEl.textContent = originalText;
                        }

                        function saveEditing(segmentEl, newText, segmentIndex, slideIndex) {
                            currentEditingSegment = null;
                            segmentEl.classList.remove('editing');
                            segmentEl.textContent = newText;
                            segmentEl.dataset.text = newText;

                            channel.postMessage({
                                type: 'update-segment',
                                slideIndex: slideIndex,
                                segmentIndex: segmentIndex,
                                text: newText
                            });
                        }

                        channel.onmessage = (e) => {
                            if (e.data.type === 'sync') {
                                document.getElementById('current-slide').textContent = e.data.slideIndex + 1;
                                document.getElementById('total-slides').textContent = e.data.totalSlides;
                                document.getElementById('slide-title').textContent = e.data.slideTitle;

                                // Update progress
                                document.getElementById('progress-text').textContent = e.data.elementIndex + ' of ' + e.data.totalElements;
                                document.getElementById('progress-fill').style.width = e.data.progressPercent + '%';
                                document.getElementById('progress-percent').textContent = e.data.progressPercent + '%';

                                // Update modified indicator
                                const modIndicator = document.getElementById('modified-indicator');
                                modIndicator.style.display = e.data.isModified ? 'inline' : 'none';

                                // Update animation info in header
                                const animInfo = document.getElementById('anim-info');
                                if (animInfo && e.data.totalElements > 0) {
                                    animInfo.textContent = ' - Click ' + e.data.elementIndex + '/' + e.data.totalElements;
                                }

                                // Render teleprompter content
                                const teleprompterContent = document.getElementById('teleprompter-content');
                                teleprompterContent.innerHTML = e.data.teleprompterHTML;

                                // Add click handlers to segments
                                teleprompterContent.querySelectorAll('.script-segment').forEach((seg) => {
                                    seg.addEventListener('click', () => {
                                        if (!seg.classList.contains('editing')) {
                                            startEditing(seg, parseInt(seg.dataset.segmentIndex), e.data.slideIndex);
                                        }
                                    });
                                });

                                // Auto-scroll to current segment if it changed
                                if (e.data.currentSegmentIndex !== lastSegmentIndex) {
                                    lastSegmentIndex = e.data.currentSegmentIndex;
                                    setTimeout(scrollToCurrentSegment, 50);
                                }

                                // Update next preview
                                document.getElementById('next-preview').innerHTML = e.data.nextNotes || '<em style="color:#666">End of presentation</em>';
                            }
                        };

                        channel.postMessage({ type: 'request-sync' });
                    <\/script>
                </body>
                </html>
                `;

                presenterWindow = window.open('', 'PresenterView', 'width=900,height=700');
                presenterWindow.document.write(presenterHTML);
                presenterWindow.document.close();
                syncPresenterView();
            }

            // Check if scripts have been modified from defaults
            function isScriptsModified() {
                return JSON.stringify(slideNotes) !== JSON.stringify(defaultSlideNotes);
            }

            // Build teleprompter HTML from script segments
            function buildTeleprompterHTML(slideData, currentSegmentIndex) {
                const segments = parseScript(slideData.script);
                let html = '';

                segments.forEach((segment, index) => {
                    // Determine segment state
                    let segmentClass = 'script-segment';
                    if (index < currentSegmentIndex) {
                        segmentClass += ' past';
                    } else if (index === currentSegmentIndex) {
                        segmentClass += ' current';
                    } else if (index === currentSegmentIndex + 1) {
                        segmentClass += ' upcoming';
                    } else {
                        segmentClass += ' far-upcoming';
                    }

                    // Add click divider before non-intro segments (when not past)
                    if (index > 0 && index >= currentSegmentIndex) {
                        const isNextClick = (index === currentSegmentIndex + 1);
                        html += `<div class="click-divider${isNextClick ? ' next-click' : ''}"><span>click</span></div>`;
                    } else if (index > 0 && index < currentSegmentIndex) {
                        // Faded click marker for past segments
                        html += `<div class="click-divider" style="opacity: 0.3"><span>click</span></div>`;
                    }

                    // Add segment
                    const escapedText = segment.text.replace(/</g, '&lt;').replace(/>/g, '&gt;');
                    html += `<div class="${segmentClass}" data-segment-index="${index}" data-text="${segment.text.replace(/"/g, '&quot;')}">${escapedText}</div>`;
                });

                // Add end-of-slide indicator if at the end
                if (currentSegmentIndex >= segments.length) {
                    html += `<div class="end-slide"><span class="arrow">→</span> End of slide - click for next slide</div>`;
                }

                return html;
            }

            // Update a specific segment in the script
            function updateScriptSegment(slideIndex, segmentIndex, newText) {
                const slideData = slideNotes[slideIndex];
                const segments = parseScript(slideData.script);

                // Rebuild script with updated segment
                segments[segmentIndex].text = newText;
                slideData.script = segments.map((seg, i) => {
                    if (i === 0) return seg.text;
                    return '[CLICK] ' + seg.text;
                }).join('\n\n');

                saveToLocalStorage();
                syncPresenterView();
            }

            function syncPresenterView() {
                const slideData = slideNotes[currentSlideIndex] || slideNotes[0];

                // Parse script into segments
                const segments = parseScript(slideData.script);

                // Build teleprompter HTML showing all segments
                const teleprompterHTML = buildTeleprompterHTML(slideData, 0);

                // Get next slide preview
                const nextSlideData = slideNotes[currentSlideIndex + 1];
                let nextNotes = null;
                if (nextSlideData) {
                    const nextSegments = parseScript(nextSlideData.script);
                    const introText = nextSegments.length > 0 ? nextSegments[0].text : '';
                    nextNotes = `
                        <div class="next-title">${nextSlideData.slideTitle}</div>
                        <div class="next-intro">${introText.substring(0, 200)}${introText.length > 200 ? '...' : ''}</div>
                    `;
                }

                channel.postMessage({
                    type: 'sync',
                    slideIndex: currentSlideIndex,
                    elementIndex: 0,
                    totalElements: 0,
                    totalSlides: slides.length,
                    slideTitle: slideData.slideTitle,
                    progressPercent: 100,
                    currentSegmentIndex: 0,
                    teleprompterHTML: teleprompterHTML,
                    nextNotes: nextNotes,
                    isModified: isScriptsModified()
                });
            }

            // ========================================
            // PERSISTENCE FUNCTIONALITY
            // ========================================
            const STORAGE_KEY = 'jan-pitch-presentation-data';

            // Listen for messages from presenter view
            channel.onmessage = (e) => {
                if (e.data.type === 'request-sync') syncPresenterView();
                else if (e.data.type === 'update-segment') {
                    updateScriptSegment(e.data.slideIndex, e.data.segmentIndex, e.data.text);
                }
                else if (e.data.type === 'reset-scripts') {
                    slideNotes = JSON.parse(JSON.stringify(defaultSlideNotes));
                    localStorage.removeItem(STORAGE_KEY);
                    syncPresenterView();
                }
            };

            function escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            // localStorage Persistence
            function saveToLocalStorage() {
                const data = {
                    slideNotes: slideNotes,
                    slideContent: extractSlideContent(),
                    savedAt: new Date().toISOString()
                };
                localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
                showSaveIndicator();
            }

            function loadFromLocalStorage() {
                const saved = localStorage.getItem(STORAGE_KEY);
                if (saved) {
                    try {
                        const data = JSON.parse(saved);
                        // Restore slideNotes - only if they have valid script content
                        if (data.slideNotes) {
                            for (let i = 0; i < data.slideNotes.length && i < slideNotes.length; i++) {
                                // Only restore if the saved note has a non-empty script
                                if (data.slideNotes[i] && data.slideNotes[i].script && data.slideNotes[i].script.trim().length > 0) {
                                    slideNotes[i] = data.slideNotes[i];
                                }
                            }
                        }
                        // Restore slide content
                        if (data.slideContent) {
                            restoreSlideContent(data.slideContent);
                        }
                        console.log('Loaded saved presentation data from', data.savedAt);
                        return true;
                    } catch (err) {
                        console.error('Failed to load saved data:', err);
                    }
                }
                return false;
            }

            function extractSlideContent() {
                const content = [];
                slides.forEach(slide => {
                    const slideContent = {};
                    const editableSelectors = 'h1, h2, h3, p, span, li';
                    slide.querySelectorAll(editableSelectors).forEach((el, i) => {
                        // Skip elements inside badges
                        if (el.closest('.header-badge') || el.closest('.check-badge') || el.closest('.why-num')) return;
                        slideContent[`el_${i}`] = el.innerHTML;
                    });
                    content.push(slideContent);
                });
                return content;
            }

            function restoreSlideContent(savedContent) {
                slides.forEach((slide, slideIdx) => {
                    const content = savedContent[slideIdx];
                    if (content) {
                        const editableSelectors = 'h1, h2, h3, p, span, li';
                        slide.querySelectorAll(editableSelectors).forEach((el, i) => {
                            // Skip elements inside badges
                            if (el.closest('.header-badge') || el.closest('.check-badge') || el.closest('.why-num')) return;
                            if (content[`el_${i}`] !== undefined) {
                                el.innerHTML = content[`el_${i}`];
                            }
                        });
                    }
                });
            }

            function showSaveIndicator() {
                const indicator = document.getElementById('save-indicator');
                indicator.classList.add('show');
                setTimeout(() => indicator.classList.remove('show'), 1500);
            }

            function resetToDefault() {
                if (confirm('Reset all edits to original content? This cannot be undone.')) {
                    localStorage.removeItem(STORAGE_KEY);
                    location.reload();
                }
            }

            function exportChanges() {
                const data = {
                    slideNotes: slideNotes,
                    slideContent: extractSlideContent(),
                    exportedAt: new Date().toISOString()
                };
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'presentation-edits.json';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            // Download updated HTML with edits baked in
            function downloadUpdatedHTML() {
                // Get the full HTML
                let html = document.documentElement.outerHTML;

                // Generate the updated defaultSlideNotes code
                const updatedNotesCode = generateSlideNotesCode(slideNotes);

                // Find and replace the defaultSlideNotes array
                // The pattern matches: const defaultSlideNotes = [ ... ];
                const regex = /const defaultSlideNotes = \[[\s\S]*?\n\s{12}\];/;

                if (regex.test(html)) {
                    html = html.replace(regex, updatedNotesCode);

                    // Wrap in DOCTYPE
                    html = '<!DOCTYPE html>\n<html' + html.substring(html.indexOf('<html') + 5);

                    // Download the file
                    const blob = new Blob([html], { type: 'text/html' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'presentation-updated.html';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);

                    showNotification('HTML downloaded with edits baked in!');
                } else {
                    alert('Could not find defaultSlideNotes in the HTML. Export as JSON instead.');
                }
            }

            // Generate JavaScript code for slideNotes array
            function generateSlideNotesCode(notes) {
                let code = 'const defaultSlideNotes = [\n';

                notes.forEach((note, index) => {
                    const slideNum = index + 1;
                    code += `                / Slide ${slideNum}: ${note.title || 'Untitled'}\n`;
                    code += '                {\n';
                    code += `                    title: ${JSON.stringify(note.title)},\n`;
                    code += `                    script: \`${formatScriptAsTemplateLiteral(note.script)}\`\n`;
                    code += '                }';
                    if (index < notes.length - 1) {
                        code += ',';
                    }
                    code += '\n';
                });

                code += '            ];';
                return code;
            }

            // Escape content for use in template literal
            function formatScriptAsTemplateLiteral(script) {
                if (!script) return '';
                return script
                    .replace(/\\/g, '\\\\')  // Escape backslashes first
                    .replace(/`/g, '\\`')    // Escape backticks
                    .replace(/\$\{/g, '\\${'); // Escape template interpolation
            }

            // Trigger file input for importing edits
            function triggerImportEdits() {
                document.getElementById('import-file-input').click();
            }

            // Handle imported JSON file
            function handleImportFile(event) {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);

                        // Validate the data structure
                        if (!validateImportData(data)) {
                            alert('Invalid import file. Expected format: { slideNotes: [...] }');
                            return;
                        }

                        // Confirm with user
                        const slideCount = data.slideNotes.length;
                        if (!confirm(`Import ${slideCount} slide scripts from "${file.name}"?\n\nThis will replace your current edits.`)) {
                            return;
                        }

                        // Apply the imported notes
                        slideNotes = JSON.parse(JSON.stringify(data.slideNotes));

                        // Save to localStorage
                        localStorage.setItem(STORAGE_KEY, JSON.stringify(slideNotes));

                        // Sync with presenter view if open
                        syncPresenterView();

                        showNotification(`Imported ${slideCount} slides from backup!`);
                    } catch (err) {
                        alert('Error parsing import file: ' + err.message);
                    }
                };
                reader.readAsText(file);

                // Reset file input so same file can be imported again
                event.target.value = '';
            }

            // Validate import data structure
            function validateImportData(data) {
                if (!data || !Array.isArray(data.slideNotes)) return false;

                // Check that each item has required properties
                return data.slideNotes.every(note =>
                    typeof note === 'object' &&
                    note !== null &&
                    'script' in note
                );
            }

            // Show a temporary notification
            function showNotification(message) {
                const indicator = document.getElementById('save-indicator');
                if (indicator) {
                    indicator.textContent = message;
                    indicator.classList.add('show');
                    setTimeout(() => {
                        indicator.classList.remove('show');
                        indicator.textContent = 'Saved';
                    }, 3000);
                }
            }

            // Toggle toolbar visibility
            function toggleToolbar(forceClose) {
                const toolbar = document.getElementById('toolbar');
                if (forceClose === true) {
                    toolbar.classList.remove('open');
                } else {
                    toolbar.classList.toggle('open');
                }
            }

            // Close toolbar when clicking outside
            document.addEventListener('click', function(e) {
                const toolbar = document.getElementById('toolbar');
                if (toolbar.classList.contains('open') && !toolbar.contains(e.target)) {
                    toolbar.classList.remove('open');
                }
            });

            // Expose functions to window for presenter view reset button
            window.resetToDefault = resetToDefault;
            window.exportChanges = exportChanges;
            window.downloadUpdatedHTML = downloadUpdatedHTML;
            window.triggerImportEdits = triggerImportEdits;
            window.handleImportFile = handleImportFile;
            window.toggleToolbar = toggleToolbar;

            // Keyboard controls - P to open presenter view only
            document.addEventListener('keydown', (e) => {
                if (e.target.matches('input, textarea, [contenteditable="true"]')) {
                    if (e.key === 'Escape') {
                        e.target.blur();
                    }
                    return;
                }

                if (e.key === 'p' || e.key === 'P') {
                    e.preventDefault();
                    openPresenterView();
                }
            });

            // Load saved data
            loadFromLocalStorage();

            // Safety check: if all scripts ended up empty after loading, reset to defaults
            const hasAnyScript = slideNotes.some(note => note.script && note.script.trim().length > 0);
            if (!hasAnyScript) {
                console.log('All scripts were empty - resetting to defaults');
                slideNotes = JSON.parse(JSON.stringify(defaultSlideNotes));
                localStorage.removeItem(STORAGE_KEY);
            }
        })();
    </script>
</body>
</html>
